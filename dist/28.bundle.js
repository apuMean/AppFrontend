webpackJsonp([28],{1369:function(t,e,a){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){return{contactoptions:t.contactoptions.contactLinkData,contactLists:t.contactoptions.contactListsData}}function i(t){return{actions:(0,C.bindActionCreators)(y,t)}}Object.defineProperty(e,"__esModule",{value:!0});var d=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),u=a(0),f=o(u),p=a(3),m=a(7),h=a(6),C=a(5),T=a(4),g=(n(T),a(1419)),y=n(g),E=a(16),b=n(E),_=a(41),k=o(_),N=a(195),I=n(N),v=a(26),S=n(v),O=a(8),A=o(O),L=!1,w=f.default.createElement("i",{className:"fa fa-times"}),D=f.default.createElement("span",null),j=f.default.createElement("span",{className:"check"}),P=f.default.createElement("span",{className:"box"}),G=f.default.createElement("div",{className:"caption"},f.default.createElement("span",{className:"caption-subject bold uppercase"},"Linked Contacts")),M=f.default.createElement("a",{href:"#multiple-contacts","data-toggle":"modal","data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle green"},f.default.createElement("i",{className:"icon-plus"}),"Link Contact"),H=f.default.createElement("thead",null,f.default.createElement("tr",null,f.default.createElement("th",null,"Name"),f.default.createElement("th",null,"Title"),f.default.createElement("th",null,"Phone"),f.default.createElement("th",null,"Internet"),f.default.createElement("th",null,"Action"))),x=f.default.createElement("h4",{className:"modal-title"},"Link Contacts"),z=f.default.createElement("div",{className:"portlet-title"},f.default.createElement("div",{className:"caption"},f.default.createElement("i",{className:"icon-users "}),f.default.createElement("span",{className:"caption-subject bold uppercase"},"Contacts"))),R=f.default.createElement("thead",null,f.default.createElement("tr",null,f.default.createElement("th",null,"Contact Name"),f.default.createElement("th",null,"Action"))),V=function(t){function e(t,a){r(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return(0,A.default)(n),n.state={contactLinkData:[],linkContactId:"",deleteIndex:"",checkboxChange:!1},n}return l(e,t),d(e,[{key:"componentWillMount",value:function(){var t={companyId:localStorage.companyId,contactId:this.props.params.contactId};this.props.actions.getContactLinks(t),this.props.actions.getContactLists(t);var e={parent:"Contacts",childone:"Linked Contacts",childtwo:""};this.props.breadCrumb(e)}},{key:"componentDidMount",value:function(){S.showLoader("linkContacts_list"),setTimeout(function(){b.ContactLinkTable.init()},2e3)}},{key:"handleMultipleCheck",value:function(t,e,a,n){this.setState({checkboxChange:!0});var o={companyId:localStorage.companyId,contactId:this.props.params.contactId,linkContactId:t,typeName:a},r={companyId:localStorage.companyId,contactId:this.props.params.contactId,linkContactId:t};1==n.target.checked?this.props.actions.addContactLinks(o):0==n.target.checked&&this.props.actions.removeContactLinks(r,"")}},{key:"doneAddContact",value:function(){if(this.state.checkboxChange||L){this.setState({checkboxChange:!1}),L=!1;var t={companyId:localStorage.companyId,contactId:this.props.params.contactId};this.props.actions.getContactLinks(t),this.props.actions.getContactLists(t)}}},{key:"handleDelete",value:function(t,e){this.setState({linkContactId:t,deleteIndex:e}),$("#contact_delete").modal("show")}},{key:"deleteUserHandler",value:function(){L=!0;var t={companyId:localStorage.companyId,contactId:this.props.params.contactId,linkContactId:this.state.linkContactId};this.state.linkContactId&&(L=!0,$("#contact_delete").modal("hide"),S.showLoader("linkContacts_list"),this.props.actions.removeContactLinks(t,"1"),this.doneAddContact())}},{key:"handleContactDetail",value:function(t){p.browserHistory.push("/contact/"+t)}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(t.contactoptions){var a=JSON.parse(JSON.stringify(t.contactoptions));this.setState({contactLinkData:a});var n=(0,m.findDOMNode)(e.refs.contact_links_list),o=(0,m.findDOMNode)(e.refs.multiple_contacts_list);$(n).DataTable().destroy();$(o).DataTable().destroy();var r=(0,m.findDOMNode)(e.refs.linkContacts_list);setTimeout(function(){b.ContactLinkTable.init(),$(r).unblock()},3e3)}}},{key:"render",value:function(){var t=this.state.contactLinkData,e="",a=t.map(function(t,a){var n=t.phoneInfo.map(function(t){if(t.isPrimary){var a=I.removeSpecialCharSpace(t.phone);return e=a.length<=11&&a.includes("x")?t.phone.substring(0,t.phone.indexOf("x")):t.phone}}),o=t.internetInfo.map(function(t){if(t.isPrimary)return t.internetvalue});return f.default.createElement("tr",{key:a},f.default.createElement("td",{onClick:this.handleContactDetail.bind(this,t.companycontactsInfo[0]._id)},t.companycontactsInfo[0].firstname," ",t.companycontactsInfo[0].lastname),f.default.createElement("td",null,t.companycontactsInfo[0].title?t.companycontactsInfo[0].title:"-"),f.default.createElement("td",null,t.phoneInfo.length?n:"-"),f.default.createElement("td",null,t.internetInfo.length?o:"-"),f.default.createElement("td",null,f.default.createElement("span",{className:"btn btn-icon-only red times",onClick:this.handleDelete.bind(this,t.companycontactsInfo[0]._id,a)},w)))}.bind(this)),n=this.props.contactLists.map(function(t,e){var a=t.contactTypeId?t.contactTypeId.typeName:"";return f.default.createElement("tr",{key:e},f.default.createElement("td",null,t.firstname," ",t.lastname),f.default.createElement("td",null,f.default.createElement("div",{className:"md-checkbox-inline"},f.default.createElement("div",{className:"md-checkbox"},f.default.createElement("input",{type:"checkbox",id:t._id,className:"md-check",onChange:this.handleMultipleCheck.bind(this,t._id,e,a)}),f.default.createElement("label",{htmlFor:t._id},D,j,P)))))}.bind(this));return f.default.createElement("div",{className:"portlet light portlet-fit portlet-datatable bordered",id:"linkContacts_list",ref:"linkContacts_list"},f.default.createElement("div",{className:"portlet-title"},G,f.default.createElement("div",{className:"actions"},M,"Â ",f.default.createElement(p.Link,{to:"/contact/"+this.props.params.contactId,className:"btn btn-sm btn-circle red"},"Back"))),f.default.createElement("div",{className:"portlet-body"},f.default.createElement("div",{className:"table-container"},f.default.createElement("table",{className:"table table-striped table-bordered table-hover",id:"contact_links_list",ref:"contact_links_list"},H,f.default.createElement("tbody",null,a)))),f.default.createElement("div",{id:"multiple-contacts",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},f.default.createElement("div",{className:"modal-dialog",id:"multiple_contacts_dialog"},f.default.createElement("div",{className:"modal-content"},f.default.createElement("div",{className:"modal-header"},x),f.default.createElement("div",{className:"modal-body"},f.default.createElement("div",{className:"portlet light portlet-fit portlet-datatable bordered"},z,f.default.createElement("div",{className:"portlet-body"},f.default.createElement("div",{className:"table-container table-responsive",style:{maxHeight:"250px",overflowY:"scroll"}},f.default.createElement("table",{className:"table table-striped table-bordered table-hover",id:"multiple_contacts_list",ref:"multiple_contacts_list"},R,f.default.createElement("tbody",null,n)))))),f.default.createElement("div",{className:"modal-footer"},f.default.createElement("button",{type:"button","data-dismiss":"modal",onClick:this.doneAddContact,className:"btn dark btn-outline"},"Close"))))),f.default.createElement(k.default,{deleteModalId:"contact_delete",deleteUserHandler:this.deleteUserHandler}))}}]),e}(f.default.Component);e.default=(0,h.connect)(s,i)(V)},1419:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e.default=t,e}function r(t){return function(e,a){N.default.post(b.GET_CONTACT_LINKS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_LINKS,linkdata:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function c(t){return function(e,a){N.default.post(b.ADD_CONTACT_LINKS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return void toastr.success(t.data.message);403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function l(t,e){return function(a,n){N.default.post(b.REMOVE_CONTACT_LINKS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return toastr.success(t.data.message),e?a({type:y.REMOVE_CONTACT_LINKS,removelinkdata:e}):void 0;403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function s(t){return function(e,a){N.default.post(b.GET_CONTACT_LISTS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_LISTS,getContacts:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function i(t){return function(e,a){N.default.post(b.GET_CONTACT_ESTIMATES,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_ESTIMATES,estimateData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function d(t){return function(e,a){N.default.post(b.GET_CONTACT_PROPOSALS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_PROPOSALS,proposalData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function u(t){return function(e,a){N.default.post(b.GET_CONTACT_PROJECTS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_PROJECTS,projectData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function f(t){return function(e,a){N.default.post(b.GET_CONTACT_POS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_POS,poData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function p(t){return function(e,a){N.default.post(b.GET_CONTACT_INVOICES,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_INVOICES,invoiceData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function m(t){return function(e,a){N.default.post(b.GET_CONTACT_ACTIVITIES,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_ACTIVITIES,activityData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function h(t){return function(t,e){N.default.get(b.GET_CONTACT_ACTIVITIES,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(e){if(200==e.data.code)return t({type:y.GET_CONTACT_ACTIVITIES,activityData:e.data.data});403==e.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(e.data.message)):toastr.error(e.data.message)}).catch(function(t){})}}function C(t){return function(e,a){N.default.post(b.GET_CONTACT_DOCUMENTS,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_DOCUMENTS,documentData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}function T(t){return function(e,a){N.default.post(b.GET_CONTACT_OPPORTUNITIES,t,{headers:{"Content-Type":"application/json",Authorization:localStorage.token}}).then(function(t){if(200==t.data.code)return e({type:y.GET_CONTACT_OPPORTUNITIES,opportunityData:t.data.data});403==t.data.code?(localStorage.clear(),I.browserHistory.push("/signin"),toastr.error(t.data.message)):toastr.error(t.data.message)}).catch(function(t){})}}Object.defineProperty(e,"__esModule",{value:!0}),e.getContactLinks=r,e.addContactLinks=c,e.removeContactLinks=l,e.getContactLists=s,e.getContactEstimates=i,e.getContactProposals=d,e.getContactProjects=u,e.getContactPOs=f,e.getContactInvoices=p,e.getContactActivities=m,e.getLinkContactActivities=h,e.getContactDocuments=C,e.getContactOpportunities=T;var g=a(4),y=o(g),E=a(25),b=o(E),_=a(9),k=(n(_),a(28)),N=n(k),I=a(3)}});