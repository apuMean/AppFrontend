webpackJsonp([41],{1403:function(e,t,a){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){return{orderNo:e.serviceOrder.orderNo,companyList:e.serviceOrder.companyList,itemDetail:e.serviceOrder.itemDetailData,salesRepList:e.serviceOrder.salesRepList,podata:e.serviceOrder.poList,contactDetails:e.serviceOrder.contactDetails,itemList:e.serviceOrder.itemList,orderTypesData:e.serviceOrder.orderTypesData,billingCompanyList:e.serviceOrder.billingCompanyList,laborRates:e.serviceOrder.laborRates,newCreatedItem:e.serviceOrder.newCreatedItem,ManufacturerList:e.serviceOrder.manufacturerList,usersData:e.serviceOrder.usersList,estimateData:e.serviceOrder.estimateList,projectData:e.serviceOrder.projectList,contractList:e.serviceOrder.contractList,companyCreated:e.estimate.companyCreated}}function m(e){return{actions:(0,g.bindActionCreators)(H,e),contactactions:(0,g.bindActionCreators)(w,e),proActions:(0,g.bindActionCreators)(q,e),poAction:(0,g.bindActionCreators)(U,e),itemaction:(0,g.bindActionCreators)(P,e),orderAction:(0,g.bindActionCreators)(G,e),userAction:(0,g.bindActionCreators)(z,e)}}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),c=a(0),p=s(c),f=a(3),h=a(7),y=s(h),v=a(12),b=s(v),N=a(9),E=s(N),D=a(6),g=a(5),T=a(1),C=s(T),x=a(198),O=s(x),I=a(76),S=s(I),k=(a(586),a(195)),_=(r(k),a(4)),M=r(_),A=a(4),R=(r(A),a(196)),P=r(R),L=a(197),w=r(L),V=a(69),H=r(V),B=a(102),q=r(B),F=a(295),U=r(F),j=a(593),G=r(j),Y=a(594),z=r(Y),W=a(23),J=s(W),Q=a(22),K=r(Q),X=r(Q),Z=a(41);s(Z);a(10);var ee=a(588),te=(s(ee),a(589)),ae=(s(te),a(26)),re=r(ae),se=a(591),ie=(s(se),a(592)),le=(s(ie),a(199)),de=(s(le),a(590)),ne=(s(de),a(300)),oe=s(ne),me=a(8),ue=s(me),ce=a(77),pe=r(ce),fe=p.default.createElement("li",{className:"active"},p.default.createElement("a",{href:"#order-add","data-toggle":"tab"},"Service Order")),he=p.default.createElement(f.Link,{to:"/order",className:"btn red"},"Cancel"),ye=p.default.createElement("label",{htmlFor:"service_number"},"Service Order #"),ve=p.default.createElement("label",{htmlFor:"customer"},"Customer",p.default.createElement("span",{className:"required"},"*")),be=p.default.createElement("option",{value:"1"},"Open"),Ne=p.default.createElement("option",{value:"2"},"In-Progress"),Ee=p.default.createElement("option",{value:"3"},"Pending"),De=p.default.createElement("option",{value:"4"},"Work Completed"),ge=p.default.createElement("option",{value:"5"},"Closed"),Te=p.default.createElement("option",{value:"6"},"Cancelled"),Ce=p.default.createElement("label",{htmlFor:"status"},"Status"),xe=p.default.createElement("label",{htmlFor:"customer"},"Billing Company",p.default.createElement("span",{className:"required"},"*")),Oe=p.default.createElement("option",{value:"0"},"Select"),Ie=p.default.createElement("label",{htmlFor:"orderType"},"Order Type",p.default.createElement("span",{className:"required"},"*")),Se=p.default.createElement("label",{htmlFor:"customer"},"Assigned"),ke=p.default.createElement("label",{htmlFor:"estimated_close_date"},"Scheduled Date"),_e=p.default.createElement("span",{className:"input-group-btn"},p.default.createElement("button",{className:"btn default date-set calendar-shadow-none",type:"button"},p.default.createElement("i",{className:"fa fa-calendar"}))),Me=p.default.createElement("label",{htmlFor:"description"},"Description of work",p.default.createElement("span",{className:"required"},"*")),Ae=p.default.createElement("label",{htmlFor:"serviceLocation"},"Service Location"),Re=p.default.createElement("option",{value:"0"},"Select"),Pe=p.default.createElement("option",{value:"other"},"Add Contract"),Le=p.default.createElement("label",{htmlFor:"contract"},"Contract"),we=p.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"}),Ve=p.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"Close"),He=function(e){function t(e,a){l(this,t);var r=d(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return(0,ue.default)(r),r.state={supplierData:[],itemPricedData:[],addType:"Add",disabled:!1,companyValue:"",companyOptions:[],billingCompanyValue:"",billingCompanyOptions:[],itemDetails:[],items:[],itemValue:"",itemOptions:[],unitPriceValue:"",salesRepOptions:[],salesRepValue:"",poValue:"",poOptions:[],addressDetails:{mapAddress1:"",mapAddress2:"",city:"",state:"",zip:""},itemTab:"active",materialTab:"",laborTab:"",laborRatesData:[],laborTypeId:"",laborTotalMore:[],laborHoursMore:[],expandTotal:!1,expandHours:!1,expandType:"",defaultMarkup:30,defaultTaxRate:9,itemDeleteIndex:"",newAddedSupplier:"",newItemAdded:"",newItemAddFlag:!1,manufacturerList:[],handleAssignOptions:[],assignValue:"",usersData:[],scheduleDate:"",assignedData:[],projectOptions:[],estimateOptions:[],modalName:"",query:"",newContactData:"",customerValue:"",createCompanyType:"",orderNumber:"",orderTypesData:[],contractList:[]},r}return n(t,e),u(t,[{key:"componentDidMount",value:function(){setTimeout(function(){X.FloatLabel.init(),K.FormValidationMd.init()},400)}},{key:"componentWillMount",value:function(){var e={companyId:localStorage.companyId},t={userId:localStorage.userId,companyId:localStorage.companyId,statusName:"Active"};this.props.orderAction.getOrderTypes(e),this.props.orderAction.getOrderContract(e),this.props.orderAction.getOrderNo(e),this.props.userAction.getUsers(t);var a={parent:"Service Orders",childone:"",childtwo:""};this.props.breadCrumb(a),this.handleSearchDebounced=O.default.debounce(function(){this.state.query&&this.props.proActions.getItemData(this.state.query,M.GET_ORDER_ITEM)},350),this.handleCompanySearchDebounced=O.default.debounce(function(){this.state.query&&this.props.actions.getCompanyList(this.state.query,M.GET_COMPANY_LIST_ORDER)},350)}},{key:"componentWillReceiveProps",value:function(e){var t=[],a=[],r={mapAddress1:"",mapAddress2:"",city:"",state:"",zip:""},s=[];e.companyList.map(function(e,a){var r={value:e._id,label:e.companyName};t.push(r)}.bind(this)),e.billingCompanyList.map(function(e,t){var r={value:e._id,label:e.companyName};a.push(r)}.bind(this));if(e.contactDetails){var i=JSON.parse(JSON.stringify(e.contactDetails)),l=i.addressInfo.find(function(e){return 1==e.isPrimary});l&&(r={mapAddress1:l.mapAddress1,mapAddress2:l.mapAddress2,city:l.city,state:l.state,zip:l.zip}),this.setState({addressDetails:r})}if(e.companyCreated&&"CUSTOMER"===this.state.createCompanyType){var d={value:e.companyCreated.id,label:e.companyCreated.label};this.setState({companyValue:d,createCompanyType:""})}if(e.companyCreated&&"BILLING"===this.state.createCompanyType){var n={value:e.companyCreated.id,label:e.companyCreated.label};this.setState({billingCompanyValue:n,createCompanyType:""})}if(e.orderNo&&this.setState({orderNumber:e.orderNo}),0!=e.orderTypesData.length&&this.setState({orderTypesData:e.orderTypesData}),0!=e.contractList.length&&this.setState({contractList:e.contractList}),e.usersData.length){e.usersData.map(function(e,t){var a={value:e._id,label:e.name?e.name:e.email};s.push(a)}.bind(this));this.setState({assignToOptions:s})}this.setState({companyOptions:t,billingCompanyOptions:a}),setTimeout(function(){X.FloatLabel.init()},400)}},{key:"componentWillUpdate",value:function(e,t){}},{key:"handleAddOtherPopup",value:function(e){e.preventDefault();var t=y.default.findDOMNode(this.refs.add_value).value;if(t.trim()){switch(this.state.addType){case"Order Type":this.props.orderAction.addOtherOrderType(t);break;case"Contract":this.props.orderAction.addOrderContract(t)}}else toastr.error(pe.VALID_VALUE)}},{key:"selectOtherType",value:function(e,t){y.default.findDOMNode(this.refs.add_value).value="","other"==t.target.value&&(t.target.selectedIndex="0",this.setState({addType:e}),$("#select-addType").modal("show"))}},{key:"handleCompanyChange",value:function(e){this.setState({companyValue:e})}},{key:"handlePoChange",value:function(e){this.setState({poValue:e})}},{key:"onInputPoChange",value:function(e){var t={poNumber:e,companyId:localStorage.companyId};this.props.poAction.getPos(t)}},{key:"onInputChange",value:function(e){var t={companyName:e,companyId:localStorage.companyId};this.props.actions.getCompanyList(t,M.GET_COMPANY_LIST_ORDER)}},{key:"onBillingInputChange",value:function(e){var t={companyName:e,companyId:localStorage.companyId};this.props.orderAction.getBillingCompanyList(t)}},{key:"handleBillingCompanyChange",value:function(e){this.setState({billingCompanyValue:e})}},{key:"onItemInputChange",value:function(e){var t=e.target.value.trim();if(t){var a={itemName:t,companyId:localStorage.companyId};this.setState({query:a}),this.handleSearchDebounced()}else this.setState({itemOptions:[],query:""})}},{key:"handlePopUpClose",value:function(e){"item"===e?(this.setState({itemValue:"",itemOptions:[]}),$("#lineitem_add").modal("hide")):"supplier"===e?$("#supplier_add").modal("hide"):"newItem"===e&&(y.default.findDOMNode(this.refs.itemEstimate.refs.item_manufacturer).value="",this.setState({manufacturerValue:"",manufacturerList:[]}),$("#add_item").modal("hide"))}},{key:"handleLineTab",value:function(e){1===e?this.setState({itemTab:"active",materialTab:"",laborTab:""}):2===e?this.setState({itemTab:"",materialTab:"active",laborTab:""}):3===e&&this.setState({itemTab:"",materialTab:"",laborTab:"active"})}},{key:"handleItemSubmit",value:function(e){var t=this.state.itemOptions[e];if(1===t.suppliersInfo.length){var a=t.suppliersInfo[0];this.handleLineItemAdd(e,a)}else t.suppliersInfo&&(this.setState({supplierData:t.suppliersInfo}),$("#supplier_add").modal({backdrop:"static",keyboard:!1}))}},{key:"handleLineItemAdd",value:function(e,t){var a="",r="";a=""===t?this.state.supplierData[e]:t,r=""!==e?this.state.itemOptions.find(function(e){return e._id===a.itemId}):this.state.newItemAdded;var s=r.manufacturer,i=r.partNumber,l=r.modal,d=r.itemName,n=1,o=!0,m=a.dealerPrice?parseInt(a.dealerPrice):0,u=m*n,c=y.default.findDOMNode(this.refs.defaultMarkup).value?parseInt(y.default.findDOMNode(this.refs.defaultMarkup).value).toFixed(1):30..toFixed(1),p=m+c/100*m,f=n*p,h=y.default.findDOMNode(this.refs.taxRate).value?parseInt(y.default.findDOMNode(this.refs.taxRate).value)/100*f:0,v=f+h,b=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].laborType:"",N=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].displayName:"",E=0!=this.state.laborRatesData.length?this.state.laborRatesData[0]._id:"",D=r.labourHour?parseInt(r.labourHour):0,g=D*n,T=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].rate:"",C=g*T,x={itemId:r._id,itemMfg:s,partNo:i,modelNo:l,itemName:d,quantity:n,mTaxable:o,mOurCost:m,mOurCostExtended:u,mMarkup:c,mCost:p,mExtended:f,mTax:h,mTaxExtended:v,laborTypeName:b,displayLaborName:N,lType:E,lHours:D,lExtended:C,lHoursExtended:g,lRate:T,rowTotal:v+C,header:"",itemTypeId:1,unit:D*T},O=this.state.itemPricedData;O.push(x),this.setState({itemPricedData:O,itemOptions:[]}),$("#lineitem_add").modal("hide"),$("#supplier_add").modal("hide")}},{key:"handleLaborAdd",value:function(e){toastr.remove();var t=y.default.findDOMNode(this.refs.labr_desc.refs.labor_description).value,a=y.default.findDOMNode(this.refs.labr_desc.refs.labor_quantity).value;if(t.trim())if(a&&parseInt(a)>0){var r={itemMfg:"",partNo:"",modelNo:"",itemName:y.default.findDOMNode(this.refs.labr_desc.refs.labor_description).value,quantity:y.default.findDOMNode(this.refs.labr_desc.refs.labor_quantity).value?parseInt(y.default.findDOMNode(this.refs.labr_desc.refs.labor_quantity).value):1,mTaxable:!1,mOurCost:0,mOurCostExtended:0,mMarkup:0,mCost:0,mExtended:0,mTax:0,mTaxExtended:0,laborTypeName:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].laborType:"",displayLaborName:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].displayName:"",lType:0!=this.state.laborRatesData.length?this.state.laborRatesData[0]._id:"",lHours:0,lExtended:0,lHoursExtended:0,lRate:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].rate:"",rowTotal:0,header:"",unit:0,itemTypeId:2},s=this.state.itemPricedData;s.push(r),this.setState({itemPricedData:s,itemTab:"",materialTab:"",laborTab:"active"}),$("#labor_add").modal("hide")}else toastr.error(pe.VALID_QUANTITY);else toastr.error(pe.REQUIRED_DESCRIPTION)}},{key:"handleHeaderAdd",value:function(e){toastr.remove();var t=y.default.findDOMNode(this.refs.head_txt.refs.subheader).value;if(""!==t.trim()){var a={header:"",headerName:t,itemTypeId:4},r=this.state.itemPricedData;r.push(a),this.setState({itemPricedData:r}),$("#subheader_add").modal("hide")}else toastr.error(pe.VALID_SUBHEADER)}},{key:"handleShippingAdd",value:function(e){toastr.remove();var t=(y.default.findDOMNode(this.refs.ship_desc.refs.description).value,y.default.findDOMNode(this.refs.ship_desc.refs.amount).value);if(t&&parseInt(t)>0){var a={itemTypeId:3,header:"",rowTotal:y.default.findDOMNode(this.refs.ship_desc.refs.amount).value?parseInt(y.default.findDOMNode(this.refs.ship_desc.refs.amount).value):0,itemName:y.default.findDOMNode(this.refs.ship_desc.refs.description).value},r=this.state.itemPricedData;r.push(a),this.setState({itemPricedData:r}),$("#shipping_add").modal("hide")}else toastr.error(pe.VALID_AMOUNT)}},{key:"onChangeGlobalTaxRate",value:function(e){var t=e.target.value;this.setState({defaultTaxRate:t})}},{key:"handleGlobalTaxRate",value:function(e){var t=parseInt(this.state.defaultTaxRate);if(t>=0&&t<=100&&0!==this.state.itemPricedData.length){var a=this.state.itemPricedData;a.forEach(function(e,t){1!=e.itemTypeId&&2!=e.itemTypeId||(a[t].mTax=this.state.defaultTaxRate?parseInt(this.state.defaultTaxRate)/100*a[t].mExtended:0,a[t].mTaxExtended=a[t].mExtended+a[t].mTax,a[t].rowTotal=a[t].mTaxExtended+a[t].lExtended)}.bind(this)),this.setState({itemPricedData:a,defaultTaxRate:t})}else(isNaN(t)||""==t)&&(this.setState({defaultTaxRate:9}),setTimeout(function(){X.FloatLabel.init()},200))}},{key:"onChangeGlobalMarkup",value:function(e){var t=e.target.value;this.setState({defaultMarkup:t})}},{key:"handleGlobalMarkup",value:function(e){var t=parseInt(this.state.defaultMarkup);if(t>=0&&t<=100&&0!==this.state.itemPricedData.length){var a=this.state.itemPricedData;a.forEach(function(e,r){1!=e.itemTypeId&&2!=e.itemTypeId||(a[r].mMarkup=t,a[r].mCost=a[r].mOurCost+a[r].mMarkup/100*a[r].mOurCost,a[r].mExtended=a[r].quantity*a[r].mCost,a[r].mTax=this.state.defaultTaxRate?parseInt(this.state.defaultTaxRate)/100*a[r].mExtended:0,a[r].mTaxExtended=a[r].mExtended+a[r].mTax,a[r].rowTotal=a[r].mTaxExtended+a[r].lExtended)}.bind(this)),this.setState({itemPricedData:a,defaultMarkup:t})}else(isNaN(t)||""==t)&&(this.setState({defaultMarkup:30}),setTimeout(function(){X.FloatLabel.init()},200))}},{key:"updateLineItemsTable",value:function(e,t,a){if("QTY"==t){var r=parseInt(a.data),s=this.state.itemPricedData,i=this.state.itemPricedData[e];i.quantity=r,i.mOurCostExtended=i.mOurCost*r,i.mExtended=i.mCost*r,i.mTax=parseInt(y.default.findDOMNode(this.refs.taxRate).value)/100*i.mExtended,i.mTaxExtended=i.mExtended+i.mTax,i.lHoursExtended=i.lHours*r,i.lExtended=i.lHoursExtended*i.lRate,i.rowTotal=i.mTaxExtended+i.lExtended,s.splice(e,1,i),this.setState({itemPricedData:s})}else if("DESC"==t){var l=a.data,d=this.state.itemPricedData,n=this.state.itemPricedData[e];n.itemName=l,d.splice(e,1,n),this.setState({itemPricedData:d})}else if("HOURS"==t){var o=parseFloat(a.data),m=this.state.itemPricedData,u=this.state.itemPricedData[e];u.lHours=o,u.lHoursExtended=u.lHours*u.quantity,u.lExtended=u.lHoursExtended*u.lRate,u.rowTotal=u.mTaxExtended+u.lExtended,u.unit=u.lRate*u.lHours,m.splice(e,1,u),this.setState({itemPricedData:m})}else if("LABOR"==t||"RATE"==t){var c=parseInt(a.data),p=this.state.itemPricedData,f=this.state.itemPricedData[e];f.lRate=c,f.lExtended=f.lHoursExtended*f.lRate,f.rowTotal=f.mTaxExtended+f.lExtended,f.unit=f.lRate*f.lHours,p.splice(e,1,f),this.setState({itemPricedData:p})}}},{key:"updateDesc",value:function(e,t,a){if("DESC"==t){var r=a.data,s=this.state.itemPricedData,i=this.state.itemPricedData[e];i.itemName=r,s.splice(e,1,i),this.setState({itemPricedData:s})}else if("ROWTOTAL"==t){var l=parseInt(a.data),d=this.state.itemPricedData,n=this.state.itemPricedData[e];n.rowTotal=l,d.splice(e,1,n),this.setState({itemPricedData:d})}}},{key:"handleDelete",value:function(e){this.setState({itemDeleteIndex:e}),$("#lineItem_delete").modal("show")}},{key:"deletePricedItem",value:function(){if(""!==this.state.itemDeleteIndex){$("#lineItem_delete").modal("hide");var e=this.state.itemPricedData;e:for(var t=0;t<e.length;t++)if(t>this.state.itemDeleteIndex)if(e[t].headerName){if(e[t].headerName)break e}else e[t].header="";e.splice(this.state.itemDeleteIndex,1),this.setState({itemPricedData:e,itemDeleteIndex:""})}}},{key:"isTaxableUpdate",value:function(e,t,a){if("TAXABLE"==t){var r=a.target.checked,s=this.state.itemPricedData,i=this.state.itemPricedData[e];i.mTaxable=r,i.mTax=r?parseInt(y.default.findDOMNode(this.refs.taxRate).value)/100*i.mExtended:0,i.mTaxExtended=i.mExtended+i.mTax,i.rowTotal=i.mTaxExtended+i.lExtended,s.splice(e,1,i),this.setState({itemPricedData:s})}}},{key:"handleLaborChange",value:function(e,t){var a=t.laborType,r=this.state.itemPricedData;r[e].lType=a._id,r[e].displayLaborName=a.displayName,r[e].laborTypeName=a.laborType,r[e].lRate=a.rate,this.setState({itemPricedData:r});var s={data:a.rate};this.updateLineItemsTable(e,"LABOR",s)}},{key:"onChangeMarkupCost",value:function(e,t,a){if("MARKUP"==t){var r=parseInt(a.data),s=this.state.itemPricedData,i=this.state.itemPricedData[e];i.mMarkup=r,i.mCost=i.mOurCost+i.mMarkup/100*i.mOurCost,i.mExtended=i.quantity*i.mCost,i.mTax=y.default.findDOMNode(this.refs.taxRate).value?parseInt(y.default.findDOMNode(this.refs.taxRate).value)/100*i.mExtended:0,i.mTaxExtended=i.mExtended+i.mTax,i.rowTotal=i.mTaxExtended+i.lExtended,s.splice(e,1,i),this.setState({itemPricedData:s})}else if("COST"==t){var l=parseInt(a.data),d=this.state.itemPricedData,n=this.state.itemPricedData[e];n.mCost=l,n.mMarkup=(n.mCost-n.mOurCost)/n.mOurCost*100,n.mExtended=n.quantity*n.mCost,n.mTax=y.default.findDOMNode(this.refs.taxRate).value?parseInt(y.default.findDOMNode(this.refs.taxRate).value)/100*n.mExtended:0,n.mTaxExtended=n.mExtended+n.mTax,n.rowTotal=n.mTaxExtended+n.lExtended,d.splice(e,1,n),this.setState({itemPricedData:d})}}},{key:"handleExpand",value:function(e){if("TOTAL"===e){var t=!this.state.expandTotal;this.setState({expandTotal:t})}else if("HOURS"===e){var a=!this.state.expandHours;this.setState({expandHours:a})}}},{key:"handleSalesRepChange",value:function(e){this.setState({salesRepValue:e})}},{key:"onInputChangeSalesRep",value:function(e){var t={firstname:e,companyId:localStorage.companyId};this.props.actions.getSalesRepData(t)}},{key:"confirmationHandler",value:function(){$("#confirm_id").modal("hide"),$("#add_item").modal("show")}},{key:"addItemHandler",value:function(){if((0,E.default)("#add_other_item").valid()){var e=y.default.findDOMNode(this.refs.itemEstimate.refs.item_name).value.trim(),t=y.default.findDOMNode(this.refs.itemEstimate.refs.item_modalNo).value.trim(),a=y.default.findDOMNode(this.refs.itemEstimate.refs.item_partNo).value.trim(),r=y.default.findDOMNode(this.refs.itemEstimate.refs.item_manufacturer).value.trim(),s=y.default.findDOMNode(this.refs.itemEstimate.refs.supplierName).value.trim(),i=y.default.findDOMNode(this.refs.itemEstimate.refs.listPrice).value.trim(),l=y.default.findDOMNode(this.refs.itemEstimate.refs.dealerPrice).value.trim(),d=[{supplierName:s,listPrice:i.replace(/[^0-9.]/g,""),dealerPrice:l.replace(/[^0-9.]/g,""),priceDate:(0,C.default)()}],n={companyId:localStorage.companyId,itemName:e,modal:t,partNumber:a,manufacturer:r,itemStatus:"Active",suppliers:d,createdBy:localStorage.userName};this.setState({newAddedSupplier:d,newItemAddFlag:!0}),this.props.itemaction.createItemNew(n),$("#add_item").modal("hide"),$("#lineitem_add").modal("hide")}}},{key:"createItemHandler",value:function(){$("#add_item").modal("show")}},{key:"getManufacturerList",value:function(e){if(e.target.value&&e.target.value.trim()){this.setState({manufacturerValue:e.target.value});var t={companyId:localStorage.companyId,manufacturer:e.target.value.trim()};this.props.proActions.getManufacturerList(t)}else this.setState({manufacturerList:[],manufacturerValue:""})}},{key:"selectManufacturer",value:function(e){this.setState({manufacturerValue:e,manufacturerList:[]})}},{key:"handleAssignOptions",value:function(e){var t=[];e.map(function(e){var a={userId:e.value,userName:e.label};t.push(a)}),this.setState({assignValue:e,assignedData:t})}},{key:"handleScheduledDate",value:function(e,t){var a=t.startDate.format("MM/DD/YYYY");this.setState({scheduleDate:a})}},{key:"isStringValidNumber",value:function(e){var t=parseInt(e);return!(isNaN(t)||t<0)&&t}},{key:"isStringValidLabor",value:function(e){var t=parseFloat(e);return!(isNaN(t)||t<0)&&t.toString()}},{key:"handleModalOpen",value:function(e){var t=this;t.state.modalName="",$(e).modal({backdrop:"static"}),t.state.modalName=e}},{key:"handleCustomerChange",value:function(e){this.setState({customerValue:e})}},{key:"handleSelectsBlur",value:function(){this.props.orderAction.clearSelects()}},{key:"onCompanyInputChange",value:function(e){if(e.trim()){var t={companyName:e,companyId:localStorage.companyId};this.setState({query:t}),this.handleCompanySearchDebounced()}else this.props.orderAction.clearSelects(),this.setState({query:"",companyOptions:[]})}},{key:"handleCompanyAdd",value:function(){toastr.remove();var e=y.default.findDOMNode(this.refs.companyChild.refs.new_customer).value.trim();if(e){var t={userId:localStorage.userId,companyId:localStorage.companyId,parentContactId:this.state.customerValue?this.state.customerValue.value:"",companyName:e,userType:1,statusId:localStorage.statusNameId,createdBy:localStorage.userName};this.props.proActions.addOtherCompany(t),$("#add-company").modal("hide")}else toastr.error("Please fill in a valid company name.")}},{key:"handleNewCompanyModal",value:function(e){toastr.remove(),"CUSTOMER"===e?(y.default.findDOMNode(this.refs.companyChild.refs.new_customer).value="",this.setState({customerValue:"",createCompanyType:e}),$("#add-company").modal({backdrop:"static",keyboard:!1})):"BILLING"===e&&(y.default.findDOMNode(this.refs.companyChild.refs.new_customer).value="",this.setState({customerValue:"",createCompanyType:e}),$("#add-company").modal({backdrop:"static",keyboard:!1}))}},{key:"orderHandler",value:function(){if(toastr.remove(),(0,E.default)("#createOrder").valid()){var e={companyId:localStorage.companyId,orderNumber:this.state.orderNumber,customerId:this.state.companyValue?this.state.companyValue.value:"",serviceLocation:y.default.findDOMNode(this.refs.serviceLocation).value.trim(),descriptionWork:y.default.findDOMNode(this.refs.workDescription).value.trim(),billingCompanyId:this.state.billingCompanyValue?this.state.billingCompanyValue.value:"",orderTypeId:y.default.findDOMNode(this.refs.orderType).value,contractId:y.default.findDOMNode(this.refs.contract).value,statusId:parseInt(y.default.findDOMNode(this.refs.status).value.trim()),createdBy:localStorage.userName,userIds:this.state.assignedData,scheduledDate:this.state.scheduleDate};re.showLoader("create_order"),this.props.orderAction.createOrder(e)}}},{key:"render",value:function(){var e,t=this.state.orderTypesData.map(function(e,t){return p.default.createElement("option",{value:e._id,key:t},e.orderTypeName)}.bind(this)),a=this.state.contractList.map(function(e,t){return p.default.createElement("option",{value:e._id,key:t},e.orderContractName)}.bind(this));return p.default.createElement("div",null,p.default.createElement("div",{className:"portlet-title tabbable-line"},p.default.createElement("ul",{className:"nav nav-tabs"},fe,p.default.createElement("div",{className:"form-actions noborder text-right"},he,"  ",p.default.createElement("button",{type:"button",className:"btn blue",onClick:this.orderHandler},"Save")))),p.default.createElement("div",{className:"portlet light bordered",id:"create_order"},p.default.createElement("div",{className:"portlet-body"},p.default.createElement("div",{className:"tab-content"},p.default.createElement("div",{className:"tab-pane active",id:"order-add"},p.default.createElement("form",{role:"form",id:"createOrder"},p.default.createElement("div",{className:"form-body"},p.default.createElement("div",{className:"row"},p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement("div",{className:"form-control form-control-static",style:{fontStyle:"italic"}},this.state.orderNumber?this.state.orderNumber:"-"),ye)),p.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-floating-label",style:{marginBottom:"28px"}},ve,p.default.createElement("span",{className:"pull-right"},p.default.createElement("i",{className:"fa fa-plus-circle fa-2x","aria-hidden":"true",onClick:this.handleNewCompanyModal.bind(this,"CUSTOMER")})),p.default.createElement(b.default,{disabled:this.state.disabled,value:this.state.companyValue,placeholder:"Customer",name:"",options:this.state.companyOptions,onChange:this.handleCompanyChange,onInputChange:this.onInputChange,onBlur:this.handleSelectsBlur}))),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement("select",{className:"form-control edited",ref:"status",id:"form_control_1"},be,Ne,Ee,De,ge,Te),Ce)),p.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-floating-label",style:{marginBottom:"28px"}},xe,p.default.createElement("span",{className:"pull-right"},p.default.createElement("i",{className:"fa fa-plus-circle fa-2x","aria-hidden":"true",onClick:this.handleNewCompanyModal.bind(this,"BILLING")})),p.default.createElement(b.default,{disabled:this.state.disabled,value:this.state.billingCompanyValue,placeholder:"Billing Company",name:"",options:this.state.billingCompanyOptions,onChange:this.handleBillingCompanyChange,onInputChange:this.onBillingInputChange,onBlur:this.handleSelectsBlur}))),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement("select",{className:"form-control edited",onChange:this.selectOtherType.bind(this,"Order Type"),id:"orderType",name:"orderType",ref:"orderType"},Oe,t),Ie)),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-floating-label",style:{marginBottom:"28px"}},Se,p.default.createElement(b.default,{multi:!0,disabled:this.state.disabled,value:this.state.assignValue,placeholder:"Assigned",options:this.state.assignToOptions,onChange:this.handleAssignOptions}))),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-floating-label"},ke,p.default.createElement(J.default,{showDropdowns:!0,singleDatePicker:!0,minDate:(0,C.default)(),onApply:this.handleScheduledDate},p.default.createElement("div",{className:"input-group date form_datetime"},p.default.createElement("input",(e={type:"text",className:"selected-date-range-btn",size:"16",readOnly:!0},i(e,"className","form-control"),i(e,"defaultValue",this.state.scheduleDate),i(e,"key",this.state.scheduleDate),i(e,"id","scheduled_date"),e)),_e)))),p.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement(S.default,{style:{resize:"none"},className:"form-control",maxRows:10,rows:5,ref:"workDescription",name:"description",defaultValue:""}),Me)),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:5,ref:"serviceLocation",name:"serviceLocation",defaultValue:""}),Ae)),p.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},p.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},p.default.createElement("select",{className:"form-control edited",onChange:this.selectOtherType.bind(this,"Contract"),id:"contract",name:"contract",ref:"contract"},Re,a,Pe),Le)))))))),p.default.createElement("div",{id:"select-addType",className:"modal fade bs-modal-sm",tabIndex:"-1","aria-hidden":"true"},p.default.createElement("div",{className:"modal-dialog modal-sm"},p.default.createElement("div",{className:"modal-content"},p.default.createElement("div",{className:"modal-header"},p.default.createElement("div",{className:"actions"},we,p.default.createElement("h5",{className:"modal-title"},"Add ",this.state.addType))),p.default.createElement("div",{className:"modal-body"},p.default.createElement("input",{type:"text",className:"form-control",id:"add_value",name:"add_value",ref:"add_value",defaultValue:""})),p.default.createElement("div",{className:"modal-footer"},Ve,p.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn green",id:"send-invite-button",onClick:this.handleAddOtherPopup},"Done"))))),p.default.createElement(oe.default,{addCompanyModalId:"add-company",companyAddhandler:this.handleCompanyAdd,ref:"companyChild",customerValue:this.state.customerValue,customerOptions:this.state.companyOptions,handleCustomerChange:this.handleCustomerChange,handleSelectsBlur:this.handleSelectsBlur,onCompanyInputChange:this.onCompanyInputChange})))}}]),t}(p.default.Component);t.default=(0,D.connect)(o,m)(He)}});