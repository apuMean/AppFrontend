webpackJsonp([40],{1406:function(e,t,a){"use strict";function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function n(e,t){return{orderDetail:e.serviceOrder.orderDetails}}function s(e){return{actions:(0,y.bindActionCreators)(D,e)}}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),i=a(0),f=r(i),u=a(3),p=a(7),v=r(p),b=a(76),E=r(b),N=a(1),h=r(N),g=a(6),y=a(5),_=a(41),w=r(_),x=a(584),I=r(x),T=a(195),O=(l(T),a(4)),L=(l(O),a(16)),k=l(L),S=a(593),D=l(S),A=a(26),F=l(A),M=a(581),C=l(M),P=a(8),j=r(P),B=f.default.createElement(u.Link,{to:"/order"},"Service Orders"),H=f.default.createElement("li",{className:"active"},f.default.createElement("a",{href:"#order-add","data-toggle":"tab"}," Service Order ")),V=f.default.createElement("li",null,f.default.createElement("a",{href:"#order-moreinfo","data-toggle":"tab"}," More Info ")),W=f.default.createElement("li",null,f.default.createElement("a",{href:"#service-memos","data-toggle":"tab"},"Memos")),z=f.default.createElement(u.Link,{to:"/order",className:"btn btn-sm btn-circle red"},"Cancel "),R=f.default.createElement("label",{htmlFor:"service_number"},"Service Order #"),U=f.default.createElement("label",{htmlFor:"form_control_1"},"Customer"),Z=f.default.createElement("label",{htmlFor:"form_control_1"},"Status"),J=f.default.createElement("label",{htmlFor:"form_control_1"},"Billing Company"),q=f.default.createElement("label",{htmlFor:"form_control_1"},"OrderType"),G=f.default.createElement("label",{htmlFor:"form_control_1"},"Assigned"),K=f.default.createElement("label",{htmlFor:"form_control_1"},"Scheduled Date"),Q=f.default.createElement("label",{htmlFor:"form_control_1"},"Description of work"),X=f.default.createElement("label",{htmlFor:"name"},"Service Location"),Y=f.default.createElement("label",{htmlFor:"contract"},"Contract"),ee=f.default.createElement("label",{htmlFor:"form_control_1"},"Work Performed"),te=f.default.createElement("div",{className:"portlet-title tabbable-line"},f.default.createElement("div",{className:"caption"},f.default.createElement("span",{className:"caption-subject font-dark bold uppercase"},"Other Details"))),ae=f.default.createElement("label",{htmlFor:"form_control_1"},"Created By"),le=f.default.createElement("label",{htmlFor:"form_control_1"},"On"),re=f.default.createElement("label",{htmlFor:"form_control_1"},"Order #"),oe=f.default.createElement("label",{htmlFor:"form_control_1"},"Modified By"),me=f.default.createElement("label",{htmlFor:"form_control_1"},"On"),de=f.default.createElement("div",{className:"portlet-title"},f.default.createElement("div",{className:"caption"},f.default.createElement("span",{className:"caption-subject bold uppercase"},"Technician Info"))),ne=f.default.createElement("label",{htmlFor:"form_control_1"},"Name"),se=f.default.createElement("label",{htmlFor:"form_control_1"},"Phone"),ce=f.default.createElement("label",{htmlFor:"form_control_1"},"Start Date/Time"),ie=f.default.createElement("label",{htmlFor:"form_control_1"},"End Date/Time"),fe=f.default.createElement("label",{htmlFor:"form_control_1"},"Notes"),ue=f.default.createElement("div",{className:"portlet-title"},f.default.createElement("div",{className:"actions"},f.default.createElement("a",{href:"#serv_memos","data-toggle":"modal","data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle green"},f.default.createElement("i",{className:"icon-plus"}),"Add Memo"))),pe=f.default.createElement("thead",null,f.default.createElement("tr",null,f.default.createElement("th",null,"User"),f.default.createElement("th",null,"Date/Time"),f.default.createElement("th",null,"Message"))),ve=f.default.createElement("div",{className:"modal-header"},f.default.createElement("div",{className:"caption"},f.default.createElement("span",{className:"caption-subject bold uppercase"},"Add Memo"))),be=f.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"Cancel"),Ee=function(e){function t(e,a){o(this,t);var l=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return(0,j.default)(l),l.state={orderDetails:"",billingAddress:"",shippingAddress:"",memoList:[],orderId:"",itemPricedData:[],expandTotal:!1,expandHours:!1,itemTab:"active",materialTab:"",laborTab:"",assignedValues:[],breadcrumb:!0},l}return d(t,e),c(t,[{key:"componentWillMount",value:function(){var e={orderId:this.props.params.orderId};this.props.actions.getOrderDetails(e),setTimeout(function(){k.OrderTable.init()},2e3)}},{key:"componentDidMount",value:function(){F.showLoader("orderList")}},{key:"componentWillReceiveProps",value:function(e){var t=[];if(e.orderDetail){var a=e.orderDetail.orderDetails,l=(e.orderDetail.itemLists,a.billingAddress1+" "+a.billingAddress2+" "+a.billingCity+" "+a.billingState+" "+a.billingZip),r=a.shippingAddress1+" "+a.shippingAddress2+" "+a.shippingCity+" "+a.shippingState+" "+a.shippingZip;if(a.userIds){a.userIds.map(function(e,a){t.push(e.userName)}.bind(this))}if(this.setState({orderDetails:a,itemPricedData:e.orderDetail.itemLists,billingAddress:l,shippingAddress:r,memoList:a.memo?a.memo.reverse():[],assignedValues:t}),this.state.breadcrumb&&a.orderNumber){var o={parent:B,childone:"#"+a.orderNumber+" ("+a.customerId.companyName+")",childtwo:""};this.props.breadCrumb(o),this.state.breadcrumb=!1}$("div#orderList").unblock()}}},{key:"handleExpand",value:function(e){if("TOTAL"===e){var t=!this.state.expandTotal;this.setState({expandTotal:t})}else if("HOURS"===e){var a=!this.state.expandHours;this.setState({expandHours:a})}}},{key:"handleLineTab",value:function(e){1===e?this.setState({itemTab:"active",materialTab:"",laborTab:""}):2===e?this.setState({itemTab:"",materialTab:"active",laborTab:""}):3===e&&this.setState({itemTab:"",materialTab:"",laborTab:"active"})}},{key:"handleMemoAdd",value:function(){toastr.remove();var e=v.default.findDOMNode(this.refs.servMemo).value.trim();if(""!==e){var t={serviceOrderId:this.props.params.orderId,message:e,userName:localStorage.userName};this.props.actions.addServiceMemos(t);var a={message:e,userName:localStorage.userName,createdAt:(0,h.default)()},l=this.state.memoList;l.unshift(a),this.setState({memoList:l});$("#service_memos").DataTable().destroy(),setTimeout(function(){k.OrderTable.init()},2e3),$("#serv_memos").modal("hide")}else toastr.error("Please enter a valid memo.")}},{key:"handleDelete",value:function(){this.setState({orderId:this.props.params.orderId}),$("#order_delete").modal("show")}},{key:"deleteOrderHandler",value:function(){if(this.state.orderId){$("#order_delete").modal("hide"),F.showLoader("orderList");var e={orderId:this.state.orderId};this.props.actions.deleteOrder(e)}}},{key:"render",value:function(){var e=this.state.orderDetails,t="",a=null;return e&&(1==e.statusId?t="Open":2==e.statusId?t="In-Progress":3==e.statusId?t="Pending":4==e.statusId?t="Work Completed":5==e.statusId?t="Closed":6==e.statusId&&(t="Cancelled"),a=this.state.memoList.map(function(e,t){return f.default.createElement("tr",{key:t},f.default.createElement("td",null,e.userName),f.default.createElement("td",null,(0,h.default)(e.createdAt).format("LLL")),f.default.createElement("td",null,e.message))})),f.default.createElement("div",null,f.default.createElement("div",{className:"portlet-title tabbable-line"},f.default.createElement("ul",{className:"nav nav-tabs"},H,V,W,f.default.createElement("div",{className:"text-right"},z,"  ",this.shouldBeVisible(C.ordersAuthorize)?f.default.createElement("button",{className:"btn btn-sm btn-circle red",onClick:this.handleDelete},"Delete "):null,"  ",this.shouldBeVisible(C.ordersAuthorize)?f.default.createElement(u.Link,{to:"/order/"+this.props.params.orderId+"/edit",className:"btn btn-sm btn-circle green"},"Edit "):null))),f.default.createElement("div",{className:"portlet light bordered",id:"orderList"},f.default.createElement("div",{className:"portlet-body"},f.default.createElement("div",{className:"tab-content"},f.default.createElement("div",{className:"tab-pane active",id:"order-add"},f.default.createElement("form",{role:"form"},f.default.createElement("div",{className:"form-body"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static italic"},e?e.orderNumber:"-"),R)),f.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e?e.customerId.companyName:"-"),U)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},t),Z)),f.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.billingCompanyId?e.billingCompanyId.companyName:"-"),J)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e?e.orderTypeId.orderTypeName:"-"),q)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e&&this.state.assignedValues.length>0?this.state.assignedValues.toString():"-"),G)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e&&e.scheduledDate?e.scheduledDate:"-"),K)),f.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static",style:{whiteSpace:"pre-wrap"}},e?e.descriptionWork:"-"),Q)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static",style:{whiteSpace:"pre-wrap"}},e.serviceLocation?e.serviceLocation:"-"),X)),f.default.createElement("div",{className:"col-md-4 col-sm-4 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static",style:{whiteSpace:"pre-wrap"}},e.contractId?e.contractId.orderContractName:"-"),Y)),f.default.createElement("div",{className:"col-md-8 col-sm-8 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static",style:{whiteSpace:"pre-wrap"}},e.workPerformed?e.workPerformed:"-"),ee)))))),f.default.createElement("div",{className:"tab-pane",id:"order-moreinfo"},te,f.default.createElement("div",{className:"portlet-body"},f.default.createElement("div",{className:"tab-content"},f.default.createElement("form",{action:"#",className:"horizontal-form"},f.default.createElement("div",{className:"form-body"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-4 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"}," ",e?e.createdBy:"-"," "),ae)),f.default.createElement("div",{className:"col-md-4 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"}," ",e.createdAt?(0,h.default)(e.createdAt).format("LLL"):"-"," "),le)),f.default.createElement("div",{className:"col-md-4 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"}," ",e?e.orderNumber:"-"," "),re)),f.default.createElement("div",{className:"col-md-4 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"}," ",e.modifiedBy?e.modifiedBy:"-"," "),oe)),f.default.createElement("div",{className:"col-md-4 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},"  ",e.modifiedBy?(0,h.default)(e.updatedAt).format("LLL"):"-"," "),me))))))),de,f.default.createElement("form",{role:"form"},f.default.createElement("div",{className:"form-body"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.technicianName?e.technicianName:"-"),ne)),f.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.phone?e.phone:"-"),se))),f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.startdate?e.startdate:"-"),ce)),f.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.enddate?e.enddate:"-"),ie))),f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"form-control form-control-static"},e.notes?e.notes:"-"),fe)),e&&e.signatureImg.length>0?f.default.createElement("div",{className:"col-md-6"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement("div",{className:"fileinput fileinput-exists","data-provides":"fileinput"},f.default.createElement("div",{className:"fileinput-preview thumbnail","data-trigger":"fileinput",style:{height:"50px"}},f.default.createElement("img",{src:e.signatureImg[0].url,className:"img-responsive",alt:"Signature"}))))):null)))),f.default.createElement("div",{className:"tab-pane",id:"service-memos"},f.default.createElement("div",{className:"portlet light portlet-fit portlet-datatable bordered"},ue,f.default.createElement("div",{className:"portlet-body"},f.default.createElement("div",{className:"table-container table-responsive"},f.default.createElement("table",{className:"table table-striped table-bordered table-hover",id:"service_memos"},pe,f.default.createElement("tbody",null,a)))))),f.default.createElement("div",{id:"serv_memos",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},f.default.createElement("div",{className:"modal-dialog modal-sm"},f.default.createElement("div",{className:"modal-content"},ve,f.default.createElement("div",{className:"modal-body"},f.default.createElement("div",{className:"row"},f.default.createElement("div",{className:"col-md-12"},f.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},f.default.createElement(E.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"servMemo",name:"servMemo",id:"servMemo",defaultValue:"",key:""}))))),f.default.createElement("div",{className:"modal-footer"},be,f.default.createElement("button",{type:"button",className:"btn green",onClick:this.handleMemoAdd},"Save")))))))),f.default.createElement(w.default,{deleteModalId:"order_delete",deleteUserHandler:this.deleteOrderHandler}))}}]),t}(I.default);t.default=(0,g.connect)(n,s)(Ee)}});