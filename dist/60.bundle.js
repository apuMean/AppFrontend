webpackJsonp([60],{1354:function(e,t,a){"use strict";function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){return{breadcrumb:e.breadcrumb,userDetails:e.accountReducer.companyUserDetail,userRoles:e.accountReducer.userRoles,deleteUser:e.accountReducer.deleteUser,updateUserStatus:e.accountReducer.updateUserStatus}}function i(e){return{actions:(0,g.bindActionCreators)(D,e)}}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),u=a(0),c=s(u),f=a(7),p=s(f),h=a(3),b=a(201),v=s(b),N=a(22),y=l(N),E=a(6),g=a(5),I=a(301),D=l(I),S=a(9),U=s(S),k=a(26),w=l(k);a(302);a(125);var O=a(12),R=s(O),H=a(581),C=(l(H),a(1)),M=s(C),_=(c.default.createElement("div",{className:"form-control form-control-static"}," Invited "),c.default.createElement("i",{className:"fa fa-ban"})),L=c.default.createElement("a",{className:"btn blue","data-toggle":"modal",href:"#reinvite-user"},c.default.createElement("i",{className:"fa fa-paper-plane-o"}),"Resend Invite"),x=c.default.createElement("a",{className:"btn red","data-toggle":"modal",href:"#reset-user-password"},c.default.createElement("i",{className:"fa fa-key"}),"Password Reset"),P=c.default.createElement("i",{className:"icon-users font-dark"}),V=c.default.createElement("ul",{className:"nav nav-tabs"},c.default.createElement("li",{className:"active"},c.default.createElement("a",{href:"#user-details","data-toggle":"tab"}," Details "))),F=c.default.createElement("a",{className:"btn purple","data-toggle":"modal",href:"#delete-user"},c.default.createElement("i",{className:"fa fa-remove"}),"Delete User"),A=c.default.createElement("i",{className:"fa fa-remove"}),j=c.default.createElement("i",{className:"fa fa-save"}),q=c.default.createElement("label",{htmlFor:"firstname"},"First Name",c.default.createElement("span",{className:"required"},"*")),Y=c.default.createElement("option",{value:"0"},"Disabled"),T=c.default.createElement("option",{value:"1"},"Enabled"),W=c.default.createElement("label",{htmlFor:"status"},"Status",c.default.createElement("span",{className:"required"},"*")),z=c.default.createElement("label",{htmlFor:"lastname"},"Last Name",c.default.createElement("span",{className:"required"},"*")),J=c.default.createElement("label",{htmlFor:"role"},"Roles",c.default.createElement("span",{className:"required"},"*")),B=c.default.createElement("label",{htmlFor:"email"},"Email",c.default.createElement("span",{className:"required"},"*")),G=c.default.createElement("label",{htmlFor:"lastlogin"},"Last Login"),K=c.default.createElement("label",{htmlFor:"phone"},"Phone",c.default.createElement("span",{className:"required"},"*")),Q=c.default.createElement("label",{htmlFor:"location"},"Location"),X=c.default.createElement("label",{htmlFor:"about"},"About"),Z=c.default.createElement("div",{className:"modal-header"},c.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"}),c.default.createElement("h4",{className:"modal-title"},"Delete User")),ee=c.default.createElement("div",{className:"modal-body"},"Are you sure you want to delete this user ?"),te=c.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"No"),ae=c.default.createElement("div",{className:"modal-header"},c.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"}),c.default.createElement("h4",{className:"modal-title"},"Reset User Password")),le=c.default.createElement("div",{className:"modal-body"},"Are you sure you want to reset this user password ?"),se=c.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"No"),re=c.default.createElement("div",{className:"modal-header"},c.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"}),c.default.createElement("h4",{className:"modal-title"},"Update User Status")),ne=c.default.createElement("div",{className:"modal-body"},"Are you sure you want to update this user status ?"),de=c.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"No"),oe=c.default.createElement("div",{className:"modal-header"},c.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"}),c.default.createElement("h4",{className:"modal-title"},"Reinvite User")),ie=c.default.createElement("div",{className:"modal-body"},"Are you sure you want to reinvite this user ?"),me=c.default.createElement("button",{type:"button","data-dismiss":"modal",className:"btn dark btn-outline"},"No"),ue=function(e){function t(e,a){r(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return l.state={userData:[],firstname:"",lastname:"",email:"",phone:"",location:"",about:"",lastlogin:"",selectedStatus:"",selectedValue:"",isAccepted:"",isEnabled:"",rolesOptions:[],rolesValue:[],dataRecieved:!1,userRoles:[],companyUserId:"",userId:""},l.triggerLabel=l.triggerLabel.bind(l),l.handleSelectChange=l.handleSelectChange.bind(l),l.handleStatusChange=l.handleStatusChange.bind(l),l.updateUserHandler=l.updateUserHandler.bind(l),l.cancelHandler=l.cancelHandler.bind(l),l.deleteUserHandler=l.deleteUserHandler.bind(l),l.updateUserStatusHandler=l.updateUserStatusHandler.bind(l),l.resendInvitationHandler=l.resendInvitationHandler.bind(l),l.resetUserPasswordHandler=l.resetUserPasswordHandler.bind(l),l.handleRolesChange=l.handleRolesChange.bind(l),l}return d(t,e),m(t,[{key:"triggerLabel",value:function(){p.default.findDOMNode(this.refs.firstname).value.trim()&&(p.default.findDOMNode(this.refs.firstname).className+=" edited");p.default.findDOMNode(this.refs.lastname).value.trim()&&(p.default.findDOMNode(this.refs.lastname).className+=" edited");p.default.findDOMNode(this.refs.email).value.trim()&&(p.default.findDOMNode(this.refs.email).className+=" edited");p.default.findDOMNode(this.refs.location).value.trim()&&(p.default.findDOMNode(this.refs.location).className+=" edited");p.default.findDOMNode(this.refs.phone).value.trim()&&(p.default.findDOMNode(this.refs.phone).className+=" edited");p.default.findDOMNode(this.refs.about).value.trim()&&(p.default.findDOMNode(this.refs.about).className+=" edited")}},{key:"componentWillMount",value:function(){this.setState({dataRecieved:!0,userId:this.props.params.userId});var e={companyId:localStorage.companyId,userId:localStorage.userId},t={userId:this.props.params.userId,companyId:localStorage.companyId};this.props.actions.loadUserData(t),this.props.actions.getRoles(e)}},{key:"componentDidMount",value:function(){w.showLoader("user-details"),y.FormValidationMd.init()}},{key:"componentDidUpdate",value:function(){this.triggerLabel()}},{key:"componentWillReceiveProps",value:function(e){if(e.userDetails&&($("#user-details").unblock(),this.setState({firstname:e.userDetails.firstname,lastname:e.userDetails.lastname,email:e.userDetails.email,phone:e.userDetails.phone,location:e.userDetails.location,about:e.userDetails.about,lastlogin:e.userDetails.lastLogin,selectedStatus:e.userDetails.status,isAccepted:e.userDetails.isAccepted,isEnabled:e.userDetails.status,companyUserId:e.userDetails.companyUserId}),this.state.dataRecieved)){e.userDetails.roles.map(function(e){this.state.rolesValue.push({value:e.roleId,label:e.roleName})}.bind(this));this.setState({dataRecieved:!1})}if(e.userRoles&&0!==e.userRoles.length&&0==this.state.rolesOptions.length){e.userRoles.map(function(e){this.state.rolesOptions.push({value:e._id,label:e.roleName})}.bind(this));this.setState({userRoles:e.userRoles})}(e.deleteUser||e.updateUserStatus)&&h.browserHistory.push("/account")}},{key:"handleSelectChange",value:function(e){this.setState({selectedValue:e.target.value})}},{key:"handleStatusChange",value:function(){this.setState({selectedStatus:event.target.value})}},{key:"handleRolesChange",value:function(e){this.setState({rolesValue:e});var t=[];return e.map(function(e){var a={roleId:e.value,roleName:e.label};t.push(a)}),this.setState({roleData:t}),t}},{key:"cancelHandler",value:function(e){e.preventDefault(),h.browserHistory.push("/account/user/"+this.props.params.userId)}},{key:"updateUserHandler",value:function(e){e.preventDefault();var t={simpleUserId:this.state.userId,companyUserId:this.state.companyUserId,firstname:p.default.findDOMNode(this.refs.firstname).value.trim(),lastname:p.default.findDOMNode(this.refs.lastname).value.trim(),email:p.default.findDOMNode(this.refs.email).value.trim(),phone:p.default.findDOMNode(this.refs.phone).value.trim(),location:p.default.findDOMNode(this.refs.location).value.trim(),about:p.default.findDOMNode(this.refs.about).value.trim(),status:p.default.findDOMNode(this.refs.status).value.trim(),roles:this.state.roleData?this.state.roleData:this.handleRolesChange(this.state.rolesValue),companyId:localStorage.companyId},a={userId:this.props.params.userId,companyId:localStorage.companyId,fullname:this.state.firstname+" "+this.state.lastname,activity:"details were updated by "+localStorage.companyName,activity_type:"success"};(0,U.default)("#inviteUserEditForm").valid()&&this.props.actions.updateUser(t,a)}},{key:"deleteUserHandler",value:function(e){e.preventDefault();var t={companyId:localStorage.companyId,userId:this.props.params.userId},a={userId:this.props.params.userId,companyId:localStorage.companyId,fullname:this.state.firstname+" "+this.state.lastname,activity:"was deleted by "+localStorage.companyName,activity_type:"errornotify"};this.props.actions.deleteUser(t,a),$("#delete-user").modal("hide")}},{key:"updateUserStatusHandler",value:function(e){e.preventDefault();var t,a=this.state.isEnabled;1==a?t="0":0==a&&(t="1");var l={userId:this.props.params.userId,status:t,companyId:localStorage.companyId},s=status?"disable":"enable",r={userId:this.props.params.userId,companyId:localStorage.companyId,fullname:this.state.firstname+" "+this.state.lastname,activity:"status was "+s+"d by "+localStorage.companyName,activity_type:s};this.props.actions.changeUserStatus(l,r),$("#disable-user").modal("hide")}},{key:"resendInvitationHandler",value:function(e){e.preventDefault();var t={userId:this.props.params.userId,companyId:localStorage.companyId},a={userId:this.props.params.userId,companyId:localStorage.companyId,fullname:this.state.firstname+" "+this.state.lastname,activity:"was re sent invitation by "+localStorage.companyName,activity_type:"notify"};this.props.actions.reinviteUser(t,a),$("#reinvite-user").modal("hide")}},{key:"resetUserPasswordHandler",value:function(e){e.preventDefault();var t={companyId:localStorage.companyId,userId:this.props.params.userId},a={userId:this.props.params.userId,companyId:localStorage.companyId,fullname:this.state.userData.firstname+" "+this.state.userData.lastname,activity:"password has been reset by "+localStorage.companyName,activity_type:"notify"};this.props.actions.resetUserPassword(t,a),$("#reset-user-password").modal("hide")}},{key:"render",value:function(){var e=this;this.state.userRoles.map(function(e,t){return c.default.createElement("option",{value:e._id,key:t},e.roleName)}.bind(this));this.state.isEnabled;var t=c.default.createElement("a",{className:"btn green","data-toggle":"modal",href:"#disable-user"},_,this.state.isEnabled?"Disable User":"Enable User"),a=L,l=x;return c.default.createElement("div",{className:"portlet light bordered"},c.default.createElement("div",{className:"portlet-title tabbable-line"},c.default.createElement("div",{className:"caption"},P,c.default.createElement("span",{id:this.state.isEnabled,className:"caption-subject font-dark bold uppercase"},"User - ",this.state.firstname," ",this.state.lastname)),V),c.default.createElement("div",{className:"portlet-body"},c.default.createElement("div",{className:"tab-content"},c.default.createElement("div",{className:"tab-pane active",id:"user-details"},c.default.createElement("form",{className:"horizontal-form",id:"inviteUserEditForm"},c.default.createElement("div",{className:"form-body"},c.default.createElement("div",{className:"row clearfix margin-bottom-30"},c.default.createElement("div",{className:"col-md-8"},c.default.createElement("div",{className:"btn-group btn-group-circle"},this.state.isAccepted?l:"",this.state.isAccepted?t:"",F,this.state.isAccepted?"":a)),c.default.createElement("div",{className:"col-md-4 text-right"},c.default.createElement("button",{onClick:this.cancelHandler,className:"btn btn-sm btn-circle red"},A," Cancel"),"  ",c.default.createElement("button",{onClick:this.updateUserHandler,className:"btn btn-sm btn-circle green"},j," Save"))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("input",{type:"text",className:"form-control",name:"firstname",ref:"firstname",maxLength:"100",key:this.state.firstname,defaultValue:this.state.firstname}),q)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("select",{value:this.state.selectedStatus,onChange:this.handleStatusChange,name:"status",className:"form-control edited",ref:"status",id:"status"},Y,T),W)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("input",{type:"text",className:"form-control",name:"lastname",ref:"lastname",maxLength:"100",key:this.state.lastname,defaultValue:this.state.lastname}),z)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},J,c.default.createElement(R.default,{ref:"role",multi:!0,disabled:this.state.disabled,value:this.state.rolesValue,placeholder:"Select roles",options:this.state.rolesOptions,onChange:this.handleRolesChange,required:!0}))),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("input",{type:"email",className:"form-control",name:"email",ref:"email",maxLength:"100",key:this.state.email,defaultValue:this.state.email}),B)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("div",{className:"form-control form-control-static"}," ",this.state.lastlogin?(0,M.default)(this.state.lastlogin).format("LLL"):"-"," "),G)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(v.default,{mask:"(999) 999-9999",maskChar:"",type:"text",className:"form-control",name:"phone",ref:"phone",key:this.state.phone,defaultValue:this.state.phone}),K)),c.default.createElement("div",{className:"col-md-6"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("input",{type:"text",className:"form-control",name:"location",ref:"location",maxLength:"100",key:this.state.location,defaultValue:this.state.location}),Q)),c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("textarea",{className:"form-control",rows:"3",name:"about",ref:"about",key:this.state.about,defaultValue:this.state.about}),X)))))))),c.default.createElement("div",{id:"delete-user",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},c.default.createElement("div",{className:"modal-dialog"},c.default.createElement("div",{className:"modal-content"},Z,ee,c.default.createElement("div",{className:"modal-footer"},te,c.default.createElement("button",{type:"button",className:"btn green",onClick:this.deleteUserHandler},"Yes"))))),c.default.createElement("div",{id:"reset-user-password",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},c.default.createElement("div",{className:"modal-dialog"},c.default.createElement("div",{className:"modal-content"},ae,le,c.default.createElement("div",{className:"modal-footer"},se,c.default.createElement("button",{type:"button",className:"btn green",onClick:this.resetUserPasswordHandler},"Yes"))))),c.default.createElement("div",{id:"disable-user",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},c.default.createElement("div",{className:"modal-dialog"},c.default.createElement("div",{className:"modal-content"},re,ne,c.default.createElement("div",{className:"modal-footer"},de,c.default.createElement("button",{type:"button",className:"btn green",onClick:function(t){return e.updateUserStatusHandler(t)}},"Yes"))))),c.default.createElement("div",{id:"reinvite-user",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},c.default.createElement("div",{className:"modal-dialog"},c.default.createElement("div",{className:"modal-content"},oe,ie,c.default.createElement("div",{className:"modal-footer"},me,c.default.createElement("button",{type:"button",className:"btn green",onClick:this.resendInvitationHandler},"Yes"))))))}}]),t}(c.default.Component);t.default=(0,E.connect)(o,i)(ue)}});