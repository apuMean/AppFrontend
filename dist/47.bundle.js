webpackJsonp([47],{1387:function(e,t,a){"use strict";function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){return{companyList:e.estimate.companyList,projectList:e.estimate.projectList,proposalList:e.estimate.proposalList,companyPhoneInternet:e.estimate.companyPhoneInternet,salesRepList:e.estimate.salesRepList,individualList:e.estimate.individualList,opportunityList:e.estimate.opportunityList,estimateDetail:e.estimate.estimateDetails,itemList:e.estimate.itemList,itemDetail:e.itemCreation.itemDetailData,contactDetails:e.estimate.contactDetails,laborRates:e.estimate.laborRates,newIndividualCreated:e.estimate.individualCreated,newSalesCreated:e.estimate.salesCreated,revisionData:e.estimate.revisionData,newCreatedItem:e.estimate.newCreatedItem,ManufacturerList:e.estimate.manufacturerList,revisionNo:e.estimate.revisionNo,updatedName:e.estimate.updatedName,estimateStages:e.estimate.estimateStages}}function o(e){return{actions:(0,b.bindActionCreators)(R,e),itemaction:(0,b.bindActionCreators)(_,e),contactactions:(0,b.bindActionCreators)(k,e),settingsActions:(0,b.bindActionCreators)(L,e)}}Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(t,a,l){return a&&e(t.prototype,a),l&&e(t,l),t}}(),u=a(0),c=i(u),f=a(3),p=a(7),h=i(p),E=a(6),b=a(5),v=a(12),N=i(v),y=a(8),g=i(y),I=a(148),x=i(I),T=a(586),C=a(76),S=i(C),D=a(197),k=l(D),A=a(102),R=l(A),O=a(196),_=l(O),w=a(587),L=l(w),M=a(4),V=l(M),P=a(22),F=l(P),H=l(P),W=a(195),U=l(W),q=a(198),j=i(q),z=a(9),B=i(z),Y=a(613),Q=i(Y),G=a(599),Z=i(G),J=a(41),K=i(J);a(10);var X=a(202),ee=i(X),te=a(1),ae=i(te),le=a(588),ie=i(le),se=a(589),ne=i(se),de=a(26),re=l(de),oe=a(591),me=i(oe),ue=a(592),ce=i(ue),fe=a(199),pe=i(fe),he=a(590),Ee=i(he),be=a(585),ve=i(be),Ne=a(609),ye=i(Ne),ge=a(147),Ie=a(77),xe=l(Ie),Te=a(598),Ce=i(Te),Se=a(203),De=i(Se),ke=a(25),Ae=l(ke),Re="",Oe="",_e=c.default.createElement(f.Link,{to:"/estimate"},"Estimates"),we=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Le=c.default.createElement("i",{className:"icon-refresh font-dark"}),Me=c.default.createElement("i",{className:"fa fa-trash-o"}),Ve=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Pe=c.default.createElement("td",{className:"unselectable"},""),$e=c.default.createElement("td",{className:"unselectable"},""),Fe=c.default.createElement("td",{className:"unselectable"},""),He=c.default.createElement("b",null,"Labor: "),We=c.default.createElement("td",{className:"unselectable"},""),Ue=c.default.createElement("td",{className:"unselectable"},""),qe=c.default.createElement("i",{className:"fa fa-trash-o"}),je=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),ze=c.default.createElement("td",{className:"unselectable"},""),Be=c.default.createElement("td",{className:"unselectable"},""),Ye=c.default.createElement("td",{className:"unselectable"},""),Qe=c.default.createElement("b",null,"Shipping"),Ge=c.default.createElement("td",{className:"unselectable"},""),Ze=c.default.createElement("td",{className:"unselectable"},""),Je=c.default.createElement("td",{className:"unselectable"},""),Ke=c.default.createElement("i",{className:"fa fa-trash-o"}),Xe=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),et=c.default.createElement("i",{className:"fa fa-trash-o"}),tt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),at=c.default.createElement("span",{className:"inc"}),lt=c.default.createElement("span",{className:"check"}),it=c.default.createElement("span",{className:"box"}),st=c.default.createElement("i",{className:"fa fa-trash-o"}),nt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),dt=c.default.createElement("b",null,"Labor: "),rt=c.default.createElement("td",{className:"unselectable"},""),ot=c.default.createElement("td",{className:"unselectable"},""),mt=c.default.createElement("td",{className:"unselectable"},""),ut=c.default.createElement("td",{className:"unselectable"},""),ct=c.default.createElement("td",{className:"unselectable"},""),ft=c.default.createElement("td",{className:"unselectable"},""),pt=c.default.createElement("td",{className:"unselectable"},""),ht=c.default.createElement("td",{className:"unselectable"},""),Et=c.default.createElement("i",{className:"fa fa-trash-o"}),bt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),vt=c.default.createElement("b",null,"Shipping: "),Nt=c.default.createElement("td",{className:"unselectable"},""),yt=c.default.createElement("td",{className:"unselectable"},""),gt=c.default.createElement("td",{className:"unselectable"},""),It=c.default.createElement("td",{className:"unselectable"},""),xt=c.default.createElement("td",{className:"unselectable"},""),Tt=c.default.createElement("td",{className:"unselectable"},""),Ct=c.default.createElement("td",{className:"unselectable"},""),St=c.default.createElement("td",{className:"unselectable"},""),Dt=c.default.createElement("td",{className:"unselectable"},""),kt=c.default.createElement("td",{className:"unselectable"},""),At=c.default.createElement("i",{className:"fa fa-trash-o"}),Rt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Ot=c.default.createElement("i",{className:"fa fa-trash-o"}),_t=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),wt=c.default.createElement("i",{className:"fa fa-trash-o"}),Lt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Mt=c.default.createElement("b",null,"Labor: "),Vt=c.default.createElement("td",{className:"unselectable"},""),Pt=c.default.createElement("i",{className:"fa fa-trash-o"}),$t=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Ft=c.default.createElement("b",null,"Shipping: "),Ht=c.default.createElement("td",{className:"unselectable"},""),Wt=c.default.createElement("td",{className:"unselectable"},""),Ut=c.default.createElement("td",{className:"unselectable"},""),qt=c.default.createElement("td",{className:"unselectable"},""),jt=c.default.createElement("td",{className:"unselectable"},""),zt=c.default.createElement("td",{className:"unselectable"},""),Bt=c.default.createElement("td",{className:"unselectable"},""),Yt=c.default.createElement("td",{className:"unselectable"},""),Qt=c.default.createElement("i",{className:"fa fa-trash-o"}),Gt=c.default.createElement("td",null,c.default.createElement("span",{className:"handle"},c.default.createElement("i",{className:"fa fa-bars"}))),Zt=c.default.createElement("i",{className:"fa fa-trash-o"}),Jt=c.default.createElement("li",{className:"active"},c.default.createElement("a",{href:"#estimate-add","data-toggle":"tab"},"Estimate")),Kt=c.default.createElement("div",{className:"portlet-title"},c.default.createElement("div",{className:"caption"},c.default.createElement("span",{className:"caption-subject bold uppercase"},"General Details"))),Xt=c.default.createElement("label",{htmlFor:"salesrep"},"Sales Rep",c.default.createElement("span",{className:"required"},"*")),ea=c.default.createElement("label",{htmlFor:"individual"},"Customer",c.default.createElement("span",{className:"required"},"*")),ta=c.default.createElement("span",{className:"pull-right"},c.default.createElement("i",{className:"fa fa-plus-circle fa-2x","aria-hidden":"true"})),aa=c.default.createElement("label",{htmlFor:"individual"},"Customer Contact"),la=c.default.createElement("label",{htmlFor:"name"},"Estimate Name",c.default.createElement("span",{className:"required"},"*")),ia=c.default.createElement("div",{className:"portlet-title"},c.default.createElement("div",{className:"caption"},c.default.createElement("span",{className:"caption-subject bold uppercase"},"Billing Address"))),sa=c.default.createElement("label",{htmlFor:"billAdd1"},"Address 1"),na=c.default.createElement("label",{htmlFor:"billAdd2"},"Address 2"),da=c.default.createElement("label",{htmlFor:"billCity"},"City"),ra=c.default.createElement("label",{htmlFor:"billState"},"State"),oa=c.default.createElement("label",{htmlFor:"billZip"},"Zip"),ma=c.default.createElement("div",{className:"portlet-title"},c.default.createElement("div",{className:"caption"},c.default.createElement("span",{className:"caption-subject bold uppercase"},"Shipping Address"))),ua=c.default.createElement("label",{htmlFor:"shipAdd1"},"Address 1"),ca=c.default.createElement("label",{htmlFor:"shipAdd2"},"Address 2"),fa=c.default.createElement("label",{htmlFor:"shipCity"},"City"),pa=c.default.createElement("label",{htmlFor:"shipState"},"State"),ha=c.default.createElement("label",{htmlFor:"shipZip"},"Zip"),Ea=c.default.createElement("label",{htmlFor:"stage"},"Stage"),ba=c.default.createElement("label",{htmlFor:"defaultMarkup"},"Default Markup(%)"),va=c.default.createElement("label",{htmlFor:"project"},"Project"),Na=c.default.createElement("option",{value:"0"},"Select"),ya=c.default.createElement("label",{htmlFor:"proposal"},"Proposal"),ga=c.default.createElement("option",{value:"0"},"Select"),Ia=c.default.createElement("label",{htmlFor:"note"},"Estimate Notes"),xa=c.default.createElement("label",{htmlFor:"taxRate"},"Tax Rate(%)"),Ta=c.default.createElement("label",{htmlFor:"proposed_services"},"Proposed Services (visible on quote)"),Ca=c.default.createElement("div",{className:"caption"},c.default.createElement("i",{className:"icon-share font-dark"}),c.default.createElement("span",{className:"caption-subject font-dark bold uppercase"},"Line Items")),Sa=c.default.createElement("th",{className:"items"}),Da=c.default.createElement("th",{className:"items"},"#"),ka=c.default.createElement("th",{className:"items"},"Mfg"),Aa=c.default.createElement("th",{className:"items"},"Model No"),Ra=c.default.createElement("th",{className:"items"},"Part No"),Oa=c.default.createElement("th",{className:"items"},"Desc"),_a=c.default.createElement("th",{className:"items"},"Qty"),wa=c.default.createElement("th",{className:"rowtotal"},"Row Total"),La=c.default.createElement("th",{className:"items"}),Ma=c.default.createElement("td",null),Va=c.default.createElement("td",null),Pa=c.default.createElement("td",null),$a=c.default.createElement("td",null),Fa=c.default.createElement("td",null),Ha=c.default.createElement("td",null),Wa=c.default.createElement("td",null),Ua=c.default.createElement("td",null),qa=c.default.createElement("th",{className:"items",rowSpan:"2"}),ja=c.default.createElement("th",{className:"items",rowSpan:"2"},"#"),za=c.default.createElement("th",{className:"items",rowSpan:"2"},"Qty"),Ba=c.default.createElement("th",{className:"material",colSpan:"8"},"Material"),Ya=c.default.createElement("th",{className:"rowtotal",rowSpan:"2"},"Row Total"),Qa=c.default.createElement("th",{className:"items",rowSpan:"2"}),Ga=c.default.createElement("tr",null,c.default.createElement("th",{className:"material"},"Tax"),c.default.createElement("th",{className:"material"},"Our Cost"),c.default.createElement("th",{className:"material"},"Our Cost Ext"),c.default.createElement("th",{className:"material"},"Mark Up"),c.default.createElement("th",{className:"material"},"Cost"),c.default.createElement("th",{className:"material"},"Extended"),c.default.createElement("th",{className:"material"},"Tax"),c.default.createElement("th",{className:"material"},"Tax Extended")),Za=c.default.createElement("td",null),Ja=c.default.createElement("td",null),Ka=c.default.createElement("td",null),Xa=c.default.createElement("td",null),el=c.default.createElement("td",null),tl=c.default.createElement("td",null),al=c.default.createElement("td",null),ll=c.default.createElement("td",null),il=c.default.createElement("td",null),sl=c.default.createElement("th",{className:"items",rowSpan:"2"}),nl=c.default.createElement("th",{className:"items",rowSpan:"2"},"#"),dl=c.default.createElement("th",{className:"items",rowSpan:"2"},"Qty"),rl=c.default.createElement("th",{className:"labor",colSpan:"6"},"Labor"),ol=c.default.createElement("th",{className:"rowtotal",rowSpan:"2"},"Row Total"),ml=c.default.createElement("th",{className:"items",rowSpan:"2"}),ul=c.default.createElement("tr",null,c.default.createElement("th",{className:"labor"},"Type"),c.default.createElement("th",{className:"labor"},"Hrs"),c.default.createElement("th",{className:"labor"},"Hrs Ext"),c.default.createElement("th",{className:"labor"},"Rate"),c.default.createElement("th",{className:"labor"},"Unit"),c.default.createElement("th",{className:"labor"},"Extended")),cl=c.default.createElement("td",null),fl=c.default.createElement("td",null),pl=c.default.createElement("td",null),hl=c.default.createElement("td",null),El=c.default.createElement("td",null),bl=c.default.createElement("td",null),vl=c.default.createElement("td",null),Nl=c.default.createElement("td",null),yl=c.default.createElement("div",{className:"caption"},c.default.createElement("span",{className:"caption-subject font-dark bold"},"Add Line Item:")),gl=c.default.createElement("i",{className:"icon-plus"}),Il=c.default.createElement("i",{className:"icon-plus"}),xl=c.default.createElement("i",{className:"icon-plus"}),Tl=c.default.createElement("i",{className:"icon-plus"}),Cl=c.default.createElement("label",{htmlFor:"revisionNotes"},"Revision Notes"),Sl=c.default.createElement("caption",{className:"font-dark bold uppercase"},"Material"),Dl=c.default.createElement("th",{colSpan:"1"},"Cost"),kl=c.default.createElement("th",{colSpan:"1"},"Our Cost Ext Total"),Al=c.default.createElement("th",{colSpan:"1"},"Tax"),Rl=c.default.createElement("th",{colSpan:"1"},"Shipping"),Ol=c.default.createElement("th",{colSpan:"1"},"Total"),_l=c.default.createElement("th",{colSpan:"1"},"Markup %"),wl=c.default.createElement("th",{colSpan:"1"},"Markup Total"),Ll=c.default.createElement("caption",{className:"font-dark bold uppercase"},"Labor"),Ml=c.default.createElement("caption",{className:"font-dark bold uppercase"},"Total"),Vl=c.default.createElement("th",{colSpan:"1"},"Material"),Pl=c.default.createElement("th",{colSpan:"1"},"Labor"),$l=c.default.createElement("th",{colSpan:"1"},"Tax"),Fl=c.default.createElement("th",{colSpan:"1"},"Shipping"),Hl=c.default.createElement("th",{className:"caption-subject font-dark bold uppercase",colSpan:"1"},"Grand Total"),Wl=c.default.createElement("div",{className:"modal-header"},c.default.createElement("div",{className:"caption"},c.default.createElement("span",{className:"caption-subject bold uppercase"},"Select Supplier"))),Ul=c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",null,"Name"),c.default.createElement("th",null,"Dealer Price"),c.default.createElement("th",null,"List Price"),c.default.createElement("th",null,"Demo Price"),c.default.createElement("th",null,"Action"))),ql=function(e){function t(e,a){s(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return(0,g.default)(l),l.state={supplierData:[],itemPricedData:[],taxRate:1.8,disabled:!1,items:[],companyValue:"",individualValue:"",proposalValue:"",projectValue:"",opportunityValue:"",salesrepValue:"",itemValue:"",companyPhone:"",addressDetails:{mapAddress1:"",mapAddress2:"",city:"",state:"",zip:""},shipAddressDetails:{mapAddress1:"",mapAddress2:"",city:"",state:"",zip:""},companyOptions:[],salesrepOptions:[],opportunityOptions:[],individualOptions:[],proposalOptions:[],projectOptions:[],estimateDetails:"",itemDetails:[],itemOptions:[],unitPriceValue:"",laborRatesData:[],laborTypeId:"",contactAddType:"",newContactData:"",laborTotalMore:[],laborHoursMore:[],expandTotal:!1,expandHours:!1,expandType:"",defaultMarkup:30,defaultTaxRate:9,itemTab:"active",materialTab:"",laborTab:"",itemDeleteIndex:"",revisedItems:[],revisionNo:0,isCheckedEmpty:!1,isCheckedDuplicate:!0,itemNotExists:!0,currentRevisionId:"",newItemAdded:"",newItemAddFlag:!1,newAddedSupplier:"",manufacturerList:[],manufacturerValue:"",breadcrumb:!0,modalName:"",new_phone:"",query:"",revisionName:"",revisionNotes:"",endpoint:Ae.SOCKETURL,proposedServiceValue:De.default.createEmptyValue(),pvalue:""},l}return d(t,e),m(t,[{key:"componentWillUnmount",value:function(){clearInterval(Re),(0,Ce.default)(this.state.endpoint).disconnect()}},{key:"componentWillMount",value:function(){Re=setInterval(this.sendEditStatus,3e3);var e={companyId:localStorage.companyId},t={estimateId:this.props.params.estimateId},a={companyId:localStorage.companyId,moduleType:1};Promise.all([this.props.actions.getEstimateDetails(t),this.props.actions.getRevisionList(t)]),this.props.actions.getLaborRates(e,V.GET_LABOR_RATE),this.props.actions.getOpportunityList(e),this.props.actions.getProjectData(e),this.props.actions.getProposalData(e),this.props.settingsActions.getEstimateStages(a),this.handleItemSearchDebounced=j.default.debounce(function(){this.state.query&&this.props.actions.getItemData(this.state.query,V.GET_EST_ITEM)},350),this.handleSalesSearchDebounced=j.default.debounce(function(){this.state.query&&this.props.actions.getSalesRepData(this.state.query)},350),this.handleContactSearchDebounced=j.default.debounce(function(){this.state.query&&this.props.actions.getIndividualData(this.state.query)},350),this.handleCompanySearchDebounced=j.default.debounce(function(){this.state.query&&this.props.actions.getCompanyList(this.state.query)},350)}},{key:"componentDidMount",value:function(){F.FormValidationMd.init(),re.showLoader("update_estimate");var e=this,t=document.getElementById("update_estimate");t&&t.addEventListener("keydown",function(t){var a=t.key;"Escape"===a?e.state.modalName&&$(e.state.modalName).modal("hide"):"Enter"===a&&("#subheader_add"==e.state.modalName?e.handleHeaderAdd():"#shipping_add"==e.state.modalName?e.handleShippingAdd():"#labor_add"==e.state.modalName&&e.handleLaborAdd())}),$("body").on("hidden.bs.modal",function(){e.state.modalName=""})}},{key:"componentWillReceiveProps",value:function(e){var t=[],a=[],l=[],i=[],s=[],n={mapAddress1:"",mapAddress2:"",city:"",state:"",zip:""};if(e.updatedName){var d=this.state.revisedItems.findIndex(function(t){return t._id===e.updatedName.estimateItemId}),r=this.state.revisedItems.slice(),o=r[d].lineItems,m=o.findIndex(function(t){return t._id===e.updatedName.lineItemId});r[d].lineItems[m].spin=!1,r[d].lineItems[m].itemName=e.updatedName.itemName,this.setState({revisedItems:r})}if(0==e.companyList.length&&0==e.individualList.length&&0==e.salesRepList.length&&0!=e.estimateDetail.length){var u=JSON.parse(JSON.stringify(e.estimateDetail.estimateDetails));if(this.state.breadcrumb&&u.estimateNumber){var c=u.customerId?" ("+u.customerId.companyName+")":"",f={parent:_e,childone:"#"+u.estimateNumber+c,childtwo:""};this.props.breadCrumb(f),this.state.breadcrumb=!1}var p={value:u.customerId?u.customerId._id:"",label:u.customerId?u.customerId.companyName:""},h={id:u.projectId?u.projectId._id:"",label:u.projectId?u.projectId.title:""},E={id:u.proposalId?u.proposalId._id:"",label:u.proposalId?u.proposalId.proposalNumber:""},b={value:u.individualId?u.individualId._id:"",label:u.individualId?u.individualId.firstname+" "+u.individualId.lastname:""},v={id:u.opportunityId?u.opportunityId._id:"",label:u.opportunityId?u.opportunityId.opportunityNumber:"",customerId:u.opportunityId?u.opportunityId.contactId:""},N={value:u.salesRep?u.salesRep._id:"",label:u.salesRep?u.salesRep.firstname+" "+u.salesRep.lastname:""},y={mapAddress1:u.billingAddress1,mapAddress2:u.billingAddress2,city:u.billingcity,state:u.billingstate,zip:u.billingzip},g={mapAddress1:u.shippingAddress1,mapAddress2:u.shippingAddress2,city:u.shippingcity,state:u.shippingstate,zip:u.shippingzip};this.setState({estimateDetails:u,companyValue:p,projectValue:h.id?h.id:"",proposalValue:E.id?E.id:"",individualValue:b.value?b:"",opportunityValue:this.state.opportunityValue?this.state.opportunityValue:v.id,salesrepValue:N,addressDetails:y,shipAddressDetails:g,pvalue:u.proposedServices?u.proposedServices:""})}if(this.state.revisedItems.length!=e.revisionData.length){var I=JSON.parse(JSON.stringify(e.revisionData));this.setState({revisedItems:I});var x=[];if(this.state.itemNotExists){if(x=I[0].lineItems,this.state.pvalue)if("Rev0"==I[0].revisionName)this.setState({proposedServiceValue:De.default.createValueFromString(this.state.pvalue,"html")});else if(I[0].proposedServices){var T=I[0].proposedServices.toString("html");this.setState({proposedServiceValue:De.default.createValueFromString(T,"html")})}else this.setState({proposedServiceValue:De.default.createEmptyValue()});this.setState({itemPricedData:x,itemNotExists:!1,currentRevisionId:I[0]._id,revisionNotes:I[0].revisionNotes?I[0].revisionNotes:""});var C=this,S="sortable",D=0;"active"==C.state.itemTab?S="sortable":"active"==C.state.materialTab?S="sortable1":"active"==C.state.laborTab&&(S="sortable2"),$(function(){$("#"+S).sortable({handle:".handle",update:function(e,t){var a=[];$("#"+S).sortable("toArray",{attribute:"data-id"}).map(function(e){a.push(x[e])}),a.forEach(function(e,t){e:if(t>D)if(e.headerName){if(e.headerName){D=0;break e}}else e.header=a[D].headerName}),C.setState({itemPricedData:a}),C.updateRevisionItems(a),$("#"+S).sortable("cancel")},change:function(e,t){var a=t.placeholder.index();a>-1&&(D=a)}})})}}if(0!=e.individualList.length){e.individualList.map(function(e,a){var l={value:e._id,label:e.firstname+" "+e.lastname};t.push(l)}.bind(this))}if(0!=e.salesRepList.length){e.salesRepList.map(function(e,t){var a={value:e._id,label:e.firstname+" "+e.lastname};l.push(a)}.bind(this))}if(0!=e.opportunityList.length){e.opportunityList.map(function(e,t){var a={id:e._id,label:e.opportunityNumber,customerId:e.contactId};i.push(a)}.bind(this))}if(0!=e.laborRates.length){e.laborRates.map(function(e,t){var a={value:e._id,text:e.laborType,_id:e._id,id:e._id,laborType:e.laborType,displayName:e.displayName,rate:localStorage.laborRate?localStorage.laborRate:e.rate};s.push(a)}.bind(this))}if(0!=e.companyList.length){e.companyList.map(function(e,t){var l={value:e._id,label:e.companyName};a.push(l)}.bind(this))}if($("div#update_estimate").unblock(),e.contactDetails){var k=JSON.parse(JSON.stringify(e.contactDetails));Oe!=k.companyName&&(this.setState({individualOptions:[]}),Oe="");var A=k.addressInfo.find(function(e){return 1==e.isPrimary});A&&(n={mapAddress1:A.mapAddress1,mapAddress2:A.mapAddress2,city:A.city,state:A.state,zip:A.zip});var R={value:k._id,label:k.companyName};this.setState({companyValue:R,addressDetails:n})}if(e.newIndividualCreated&&"N"===this.state.newContactData){var O={value:e.newIndividualCreated.id,label:e.newIndividualCreated.label};this.setState({individualValue:O,newContactData:""})}if(e.newSalesCreated&&"S"===this.state.newContactData){var _={value:e.newSalesCreated.id,label:e.newSalesCreated.label};this.setState({salesrepValue:_,newContactData:""})}if(this.state.newItemAddFlag&&e.newCreatedItem){var w={itemName:e.newCreatedItem.itemName,modal:e.newCreatedItem.modal,partNumber:e.newCreatedItem.partNumber,manufacturer:e.newCreatedItem.manufacturer,labourHour:0,_id:e.newCreatedItem._id},L={itemId:e.newCreatedItem._id,dealerPrice:this.state.newAddedSupplier?this.state.newAddedSupplier[0].dealerPrice:0};this.state.newItemAddFlag=!1,this.state.newItemAdded=w,this.handleLineItemAdd("",L)}this.setState({companyOptions:a,projectOptions:e.projectList,proposalOptions:e.proposalList,individualOptions:t,salesrepOptions:l,opportunityOptions:e.opportunityList,itemOptions:this.state.query?e.itemList:[],laborRatesData:s,manufacturerList:e.ManufacturerList,revisionNo:e.revisionNo?e.revisionNo:0}),setTimeout(function(){H.FloatLabel.init()},400),$(".lineitem").tableHeadFixer()}},{key:"componentWillUpdate",value:function(e,t){var a=this,l="sortable",i=0;"active"==a.state.itemTab?l="sortable":"active"==a.state.materialTab?l="sortable1":"active"==a.state.laborTab&&(l="sortable2"),$("#"+l).sortable({handle:".handle",update:function(e,s){var n=[];$("#"+l).sortable("toArray",{attribute:"data-id"}).map(function(e){n.push(t.itemPricedData[e])}),n.forEach(function(e,t){e:if(t>i)if(e.headerName){if(e.headerName){i=0;break e}}else e.header=n[i].headerName}),a.setState({itemPricedData:n}),a.updateRevisionItems(n),$("#"+l).sortable("cancel")},change:function(e,t){var a=t.placeholder.index();a>-1&&(i=a)}})}},{key:"onChange",value:function(e){this.setState({proposedServiceValue:e})}},{key:"handleNewContactModal",value:function(e){this.state.companyValue?(this.setState({contactAddType:e,new_phone:""}),$("#add-contact").modal({backdrop:"static",keyboard:!1})):toastr.error(xe.REQUIRED_OPPORTUNITY_SELECT)}},{key:"handleContactAdd",value:function(){if(toastr.remove(),(0,B.default)("#add_other_contact").valid()){var e=h.default.findDOMNode(this.refs.contactChild.refs.new_phone).value,t=e?U.removeSpecialCharSpace(e):"",a=[],l=[],i={phonetype:"Work",phone:h.default.findDOMNode(this.refs.contactChild.refs.new_phone).value.trim(),isPrimary:!0};a.push(i);var s={internetType:"Work",internetvalue:h.default.findDOMNode(this.refs.contactChild.refs.new_email).value.trim(),isPrimary:!0};l.push(s);var n={userId:localStorage.userId,companyId:localStorage.companyId,phone:a,internet:l,companyName:this.state.companyValue.label,companyContactId:this.state.companyValue.value,firstname:h.default.findDOMNode(this.refs.contactChild.refs.first_name).value.trim(),lastname:h.default.findDOMNode(this.refs.contactChild.refs.last_name).value.trim(),statusId:localStorage.statusNameId,userType:2,createdBy:localStorage.userName};if(""!==e)if(t.length>=11&&t.includes("x")){var d=t.substring(0,t.indexOf("x"));d.length<10?toastr.error(xe.VALID_PHONE):("SALES"==this.state.contactAddType?(n.isSalesRep=!0,this.setState({newContactData:"S"})):this.setState({newContactData:"N"}),this.props.actions.addOtherContact(n,this.state.contactAddType),$("#add-contact").modal("hide"))}else t.length>=11?("SALES"==this.state.contactAddType?(n.isSalesRep=!0,this.setState({newContactData:"S"})):this.setState({newContactData:"N"}),this.props.actions.addOtherContact(n,this.state.contactAddType),$("#add-contact").modal("hide")):toastr.error(xe.VALID_PHONE);else"SALES"==this.state.contactAddType?(n.isSalesRep=!0,this.setState({newContactData:"S"})):this.setState({newContactData:"N"}),this.props.actions.addOtherContact(n,this.state.contactAddType),$("#add-contact").modal("hide")}}},{key:"onContactFocus",value:function(){toastr.remove(),this.state.companyValue.value||toastr.error(xe.REQUIRED_OPPORTUNITY_SELECT)}},{key:"handleExpand",value:function(e){if("TOTAL"===e){var t=!this.state.expandTotal;this.setState({expandTotal:t})}else if("HOURS"===e){var a=!this.state.expandHours;this.setState({expandHours:a})}}},{key:"handleIndividualChange",value:function(e){this.setState({individualValue:e})}},{key:"handleCompanyChange",value:function(e){if(e){this.setState({companyValue:e});var t={contactId:e.value};this.props.actions.getCustomerDetails(t)}else this.setState({companyValue:"",individualValue:"",addressDetails:""})}},{key:"onCompanyInputChange",value:function(e){if(e.trim()){var t={companyName:e,companyId:localStorage.companyId};this.setState({query:t}),this.handleCompanySearchDebounced()}else this.props.actions.clearSelects(),this.setState({individualOptions:[],query:"",companyOptions:[]})}},{key:"handleSelectsBlur",value:function(){this.props.actions.clearSelects()}},{key:"handleProposalChange",value:function(e){var t=e.target.value;""!==t&&"0"!=t?this.setState({proposalValue:t}):this.setState({proposalValue:""})}},{key:"handleProjectChange",value:function(e){var t=e.target.value;""!==t&&"0"!=t?this.setState({projectValue:t}):this.setState({projectValue:""})}},{key:"handleOpportunityChange",value:function(e){var t="",a=e.target.value;if(""!==a&&"0"!=a){this.setState({opportunityValue:e.target.value});var l=this.state.opportunityOptions.find(function(t){return t._id===e.target.value});h.default.findDOMNode(this.refs.name).value=l.opportunityNumber;var i={contactId:l.contactId};l.individualId&&(t={value:l.individualId._id,label:l.individualId.firstname+" "+l.individualId.lastname}),this.props.actions.updateOpportunityState(),this.props.actions.getCustomerDetails(i),this.setState({individualValue:t,individualOptions:[],companyValue:"",addressDetails:""})}else this.props.actions.updateOpportunityState(),h.default.findDOMNode(this.refs.name).value="",this.setState({opportunityValue:"",individualValue:"",individualOptions:[],companyValue:"",addressDetails:""})}},{key:"handleSalesRepChange",value:function(e){this.setState({salesrepValue:e})}},{key:"handlePopUpClose",value:function(e){"item"===e?(this.setState({itemValue:"",itemOptions:[]}),$("#lineitem_add").modal("hide")):"supplier"===e?$("#supplier_add").modal("hide"):"newItem"===e&&(h.default.findDOMNode(this.refs.itemEstimate.refs.item_manufacturer).value="",this.setState({manufacturerValue:"",manufacturerList:[]}),$("#add_item").modal("hide"))}},{key:"onIndividualInputChange",value:function(e){var t=this.state.companyValue.value;if(t)if(e.trim()){var a={firstname:e,companyId:localStorage.companyId,contactId:t};this.setState({query:a}),this.handleContactSearchDebounced()}else this.props.actions.clearSelects(),this.setState({individualOptions:[],query:""})}},{key:"onSalesRepInputChange",value:function(e){if(e.trim()){var t={firstname:e,companyId:localStorage.companyId};this.setState({query:t}),this.handleSalesSearchDebounced()}else this.props.actions.clearSelects(),this.setState({salesrepOptions:[],query:""})}},{key:"onItemInputChange",value:function(e){var t=e.target.value.trim();if(t){var a={itemName:t,companyId:localStorage.companyId};this.setState({query:a}),this.handleItemSearchDebounced()}else this.setState({itemOptions:[],query:""})}},{key:"handleItemSubmit",value:function(e){var t=this.state.itemOptions[e];if(1===t.suppliersInfo.length){var a=t.suppliersInfo[0];this.handleLineItemAdd(e,a)}else t.suppliersInfo&&(this.setState({supplierData:t.suppliersInfo}),$("#supplier_add").modal({backdrop:"static",keyboard:!1}))}},{key:"handleLineItemAdd",value:function(e,t){var a="",l="";a=""===t?this.state.supplierData[e]:t,l=""!==e?this.state.itemOptions.find(function(e){return e._id===a.itemId}):this.state.newItemAdded;var i=l.manufacturer,s=l.partNumber,n=l.modal,d=l.itemName,r=1,o=!0,m=a.dealerPrice?parseFloat(a.dealerPrice):0,u=m*r,c=h.default.findDOMNode(this.refs.defaultMarkup).value?parseInt(h.default.findDOMNode(this.refs.defaultMarkup).value).toFixed(1):30..toFixed(1),f=m+c/100*m,p=r*f,E=h.default.findDOMNode(this.refs.taxRate).value?parseInt(h.default.findDOMNode(this.refs.taxRate).value)/100*p:0,b=p+E,v=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].laborType:"",N=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].displayName:"",y=0!=this.state.laborRatesData.length?this.state.laborRatesData[0]._id:"",g=l.labourHour?parseInt(l.labourHour):0,I=g*r,x=0!=this.state.laborRatesData.length?this.state.laborRatesData[0].rate:"",T=I*x,C={itemId:l._id,itemMfg:i,partNo:s,modelNo:n,itemName:d,quantity:r,mTaxable:o,mOurCost:m,mOurCostExtended:u,mMarkup:c,mCost:f,mExtended:p,mTax:E,mTaxExtended:b,laborTypeName:v,displayLaborName:N,lType:y,lHours:g,lExtended:T,lHoursExtended:I,lRate:x,rowTotal:b+T,header:"",itemTypeId:1,unit:g*x},S=this.state.itemPricedData;S.push(C),this.setState({itemOptions:[]}),$("#lineitem_add").modal("hide"),$("#supplier_add").modal("hide"),this.updateRevisionItems(S)}},{key:"handleLaborAdd",value:function(e){if(toastr.remove(),h.default.findDOMNode(this.refs.labr_desc.refs.labor_description).value.trim()){var t={itemMfg:"",partNo:"",modelNo:"",itemName:h.default.findDOMNode(this.refs.labr_desc.refs.labor_description).value,quantity:1,mTaxable:!1,mOurCost:0,mOurCostExtended:0,mMarkup:0,mCost:0,mExtended:0,mTax:0,mTaxExtended:0,laborTypeName:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].laborType:"",displayLaborName:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].displayName:"",lType:0!=this.state.laborRatesData.length?this.state.laborRatesData[0]._id:"",lHours:0,lExtended:0,lHoursExtended:0,lRate:0!=this.state.laborRatesData.length?this.state.laborRatesData[0].rate:"",rowTotal:0,header:"",unit:0,itemTypeId:2},a=this.state.itemPricedData;a.push(t),this.setState({itemTab:"",materialTab:"",laborTab:"active"}),this.updateRevisionItems(a),$("#labor_add").modal("hide")}else toastr.error(xe.REQUIRED_DESCRIPTION)}},{key:"handleHeaderAdd",value:function(e){toastr.remove();var t=h.default.findDOMNode(this.refs.head_txt.refs.subheader).value;if(""!==t.trim()){var a={header:"",headerName:t,itemTypeId:4},l=this.state.itemPricedData;l.push(a),this.updateRevisionItems(l),$("#subheader_add").modal("hide")}else toastr.error(xe.VALID_SUBHEADER)}},{key:"handleShippingAdd",value:function(e){toastr.remove();var t=h.default.findDOMNode(this.refs.ship_desc.refs.description).value,a=h.default.findDOMNode(this.refs.ship_desc.refs.amount).value;if(a&&parseInt(a)>0){var l={itemTypeId:3,header:"",rowTotal:parseInt(a),itemName:t},i=this.state.itemPricedData;i.push(l),this.updateRevisionItems(i),$("#shipping_add").modal("hide")}else toastr.error(xe.VALID_AMOUNT)}},{key:"updateDesc",value:function(e,t,a){if("DESC"==t){var l=a.data,i=this.state.itemPricedData,s=this.state.itemPricedData[e];s.itemName=l,i.splice(e,1,s),this.updateRevisionItems(i)}else if("ROWTOTAL"==t){var n=parseInt(a.data),d=this.state.itemPricedData,r=this.state.itemPricedData[e];r.rowTotal=n,d.splice(e,1,r),this.updateRevisionItems(d)}else if("SUB_HEAD"==t){var o=[];o=this.state.itemPricedData;var m=this.state.itemPricedData[e];m.headerName=a.data,o.splice(e,1,m),this.updateRevisionItems(o),this.setState({itemPricedData:o})}}},{key:"updateLineItemsTable",value:function(e,t,a){if("QTY"==t){var l=parseInt(a.data),i=this.state.itemPricedData,s=this.state.itemPricedData[e];s.quantity=l,s.mOurCostExtended=s.mOurCost*l,s.mExtended=s.mCost*l,s.mTax=s.mTaxable?parseFloat(h.default.findDOMNode(this.refs.taxRate).value)/100*s.mExtended:0,s.mTaxExtended=s.mExtended+s.mTax,s.lHoursExtended=s.lHours*l,s.lExtended=s.lHoursExtended*s.lRate,s.rowTotal=s.mTaxExtended+s.lExtended,i.splice(e,1,s),this.updateRevisionItems(i)}else if("DESC"==t){var n=a.data,d=this.state.itemPricedData,r=this.state.itemPricedData[e];r.itemName=n,d.splice(e,1,r),this.updateRevisionItems(d)}else if("HOURS"==t){var o=parseFloat(a.data),m=this.state.itemPricedData,u=this.state.itemPricedData[e];u.lHours=o,u.lHoursExtended=u.lHours*u.quantity,u.lExtended=u.lHoursExtended*u.lRate,u.rowTotal=u.mTaxExtended+u.lExtended,u.unit=u.lRate*u.lHours,m.splice(e,1,u),this.updateRevisionItems(m)}else if("LABOR"==t||"RATE"==t){var c=parseInt(a.data);"RATE"==t&&localStorage.setItem("laborRate",c);var f=this.state.itemPricedData,p=this.state.itemPricedData[e];p.lRate=c,p.lExtended=p.lHoursExtended*p.lRate,p.rowTotal=p.mTaxExtended+p.lExtended,p.unit=p.lRate*p.lHours,f.splice(e,1,p),this.updateRevisionItems(f)}}},{key:"isTaxableUpdate",value:function(e,t,a){if("TAXABLE"==t){var l=a.target.checked,i=this.state.itemPricedData,s=this.state.itemPricedData[e];s.mTaxable=l,s.mTax=l?parseInt(h.default.findDOMNode(this.refs.taxRate).value)/100*s.mExtended:0,s.mTaxExtended=s.mExtended+s.mTax,s.rowTotal=s.mTaxExtended+s.lExtended,i.splice(e,1,s),this.updateRevisionItems(i)}}},{key:"handleLineTab",value:function(e){1===e?this.setState({itemTab:"active",materialTab:"",laborTab:""}):2===e?this.setState({itemTab:"",materialTab:"active",laborTab:""}):3===e&&this.setState({itemTab:"",materialTab:"",laborTab:"active"});var t=this,a="sortable",l=0;1===e?a="sortable":2===e?a="sortable1":3===e&&(a="sortable2"),$("#"+a).sortable({handle:".handle",update:function(e,i){var s=[];$("#"+a).sortable("toArray",{attribute:"data-id"}).map(function(e){s.push(t.state.itemPricedData[e])}),s.forEach(function(e,t){e:if(t>l)if(e.headerName){if(e.headerName){l=0;break e}}else e.header=s[l].headerName}),t.setState({itemPricedData:s}),t.updateRevisionItems(s),$("#"+a).sortable("cancel")},change:function(e,t){var a=t.placeholder.index();a>1&&(l=a)}})}},{key:"handleLaborChange",value:function(e,t){var a=t.laborType,l=this.state.itemPricedData;l[e].lType=a._id,l[e].displayLaborName=a.displayName,l[e].laborTypeName=a.laborType,l[e].lRate=a.rate,this.setState({itemPricedData:l});var i={data:a.rate};this.updateLineItemsTable(e,"LABOR",i)}},{key:"onChangeGlobalTaxRate",value:function(e){var t=e.target.value;this.setState({defaultTaxRate:t})}},{key:"handleGlobalTaxRate",value:function(e){var t=parseFloat(h.default.findDOMNode(this.refs.taxRate).value);if(t>=0&&t<=100&&0!==this.state.itemPricedData.length){var a=this.state.itemPricedData;a.forEach(function(e,t){e.mTaxable&&(1!=e.itemTypeId&&2!=e.itemTypeId||(a[t].mTax=h.default.findDOMNode(this.refs.taxRate).value?parseFloat(h.default.findDOMNode(this.refs.taxRate).value)/100*a[t].mExtended:0,a[t].mTaxExtended=a[t].mExtended+a[t].mTax,a[t].rowTotal=a[t].mTaxExtended+a[t].lExtended))}.bind(this)),this.setState({defaultTaxRate:t}),this.updateRevisionItems(a)}else(isNaN(t)||""==t)&&(h.default.findDOMNode(this.refs.taxRate).value="9");setTimeout(function(){H.FloatLabel.init()},200)}},{key:"onChangeGlobalMarkup",value:function(e){var t=e.target.value;this.setState({defaultMarkup:t})}},{key:"handleGlobalMarkup",value:function(e){var t=parseFloat(h.default.findDOMNode(this.refs.defaultMarkup).value);if(t>=0&&t<=100&&0!==this.state.itemPricedData.length){var a=this.state.itemPricedData;a.forEach(function(e,t){1!=e.itemTypeId&&2!=e.itemTypeId||(a[t].mMarkup=a[t].mMarkup,a[t].mCost=a[t].mOurCost+a[t].mMarkup/100*a[t].mOurCost,a[t].mExtended=a[t].quantity*a[t].mCost,a[t].mTax=h.default.findDOMNode(this.refs.taxRate).value?parseFloat(h.default.findDOMNode(this.refs.taxRate).value)/100*a[t].mExtended:0,a[t].mTaxExtended=a[t].mExtended+a[t].mTax,a[t].rowTotal=a[t].mTaxExtended+a[t].lExtended)}.bind(this)),this.setState({defaultMarkup:t}),this.updateRevisionItems(a)}else 0==t?h.default.findDOMNode(this.refs.defaultMarkup).value="0":(isNaN(t)||""==t)&&(h.default.findDOMNode(this.refs.defaultMarkup).value="30");setTimeout(function(){H.FloatLabel.init()},200)}},{key:"onChangeMarkupCost",value:function(e,t,a){if("MARKUP"==t){var l=parseInt(a.data),i=this.state.itemPricedData,s=this.state.itemPricedData[e];s.mMarkup=U.numberWithCommas(l.toFixed(2)),0==s.mMarkup?s.mCost=s.mOurCost+s.mOurCost:s.mCost=s.mOurCost+s.mMarkup/100*s.mOurCost,s.mExtended=s.quantity*s.mCost,s.mTax=s.mTaxable&&h.default.findDOMNode(this.refs.taxRate).value?parseFloat(h.default.findDOMNode(this.refs.taxRate).value)/100*s.mExtended:0,s.mTaxExtended=s.mExtended+s.mTax,s.rowTotal=s.mTaxExtended+s.lExtended,i.splice(e,1,s),this.updateRevisionItems(i)}else if("COST"==t){var n=parseFloat(a.data),d=this.state.itemPricedData,r=this.state.itemPricedData[e];r.mCost=n,r.mMarkup=(r.mCost-r.mOurCost)/r.mOurCost*100,r.mExtended=r.quantity*r.mCost,r.mTax=r.mTaxable&&h.default.findDOMNode(this.refs.taxRate).value?parseFloat(h.default.findDOMNode(this.refs.taxRate).value)/100*r.mExtended:0,r.mTaxExtended=r.mExtended+r.mTax,r.rowTotal=r.mTaxExtended+r.lExtended,d.splice(e,1,r),this.updateRevisionItems(d)}else if("OURCOST"==t){var o=[];o=this.state.itemPricedData;var m=this.state.itemPricedData[e],u=parseFloat(a.data);m.mOurCost=u,m.mOurCostExtended=u*m.quantity,m.mCost=u+m.mMarkup/100*u,m.mExtended=m.quantity*m.mCost,o.splice(e,1,m),this.updateRevisionItems(o),this.setState({itemPricedData:o})}}},{key:"handleDelete",value:function(e){this.setState({itemDeleteIndex:e}),$("#lineItem_delete").modal("show")}},{key:"deletePricedItem",value:function(){if(""!==this.state.itemDeleteIndex){$("#lineItem_delete").modal("hide");var e=this.state.itemPricedData;e:for(var t=0;t<e.length;t++)if(t>this.state.itemDeleteIndex)if(e[t].headerName){if(e[t].headerName)break e}else e[t].header="";e.splice(this.state.itemDeleteIndex,1),this.updateRevisionItems(e),this.setState({itemDeleteIndex:""})}}},{key:"getRevision",value:function(e,t){var a=this,l=e.target.value;if("newRevision"==l){this.props.actions.getRevisionCount({estimateId:this.props.params.estimateId});var i=this.state.revisedItems.findIndex(function(e){return e._id===a.state.currentRevisionId});e.target.selectedIndex=i;var s=this.state.revisedItems;s.length;this.setState({isCheckedEmpty:!1,isCheckedDuplicate:!0}),$("#add_revision").modal({backdrop:"static",keyboard:!1})}else if("nameRevision"==l){var n=this.state.revisedItems.findIndex(function(e){return e._id===a.state.currentRevisionId});e.target.selectedIndex=n;var d=this.state.revisedItems;this.setState({revisionName:d[n].revName?d[n].revName:""}),$("#name_revision").modal({backdrop:"static",keyboard:!1})}else if("deleteRevision"==l){var r=this.state.revisedItems.findIndex(function(e){return e._id===a.state.currentRevisionId});e.target.selectedIndex=r;var o={revisionItemId:this.state.currentRevisionId};this.setState({itemNotExists:!0}),this.props.actions.deleteRevision(o,r)}else{var m=(this.state.revisedItems,this.state.revisedItems.find(function(e){return e._id===l}));if("Rev0"==m.revisionName)this.setState({proposedServiceValue:De.default.createValueFromString(this.state.pvalue,"html")});else if(m.proposedServices){var u=m.proposedServices.toString("html");this.setState({proposedServiceValue:De.default.createValueFromString(u,"html")})}else this.setState({proposedServiceValue:De.default.createEmptyValue()});this.setState({itemPricedData:m.lineItems,currentRevisionId:l,revisionNotes:m.revisionNotes?m.revisionNotes:""})}}},{key:"handleRadioUpdate",value:function(e,t){"EMPTY"===e?this.setState({isCheckedEmpty:!0,isCheckedDuplicate:!1}):"DUPLICATE"===e&&this.setState({isCheckedEmpty:!1,isCheckedDuplicate:!0})}},{key:"updateRevisionItems",value:function(e){var t=this,a=this.state.revisedItems.findIndex(function(e){return e._id===t.state.currentRevisionId}),l=this.state.revisedItems[a].revisionName,i=this.state.revisedItems;i[a].lineItems=e,this.setState({revisedItems:i});var s=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.rowTotal:e},0),n=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mTaxExtended:e},0),d=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mTaxExtended:e},0),r=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mOurCost:e},0),o=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mOurCostExtended:e},0),m=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mExtended:e},0),u=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mTax:e},0),c=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lHoursExtended:e},0),f=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lExtended:e},0),p=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lRate:e},0),E=e.reduce(function(e,t){return 3===t.itemTypeId?e+t.rowTotal:e},0),b=m-o,v=n,N=e.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lExtended:e},0),y=100*(m/o-1),g=m+f+u+E,I={revisionId:this.state.currentRevisionId,revisionName:l,revisionNotes:this.state.revisionNotes,item:e,itemsTotal:s,ourCostTotal:r,materialExtendedTotal:m,taxTotal:u,taxExtendedTotal:n,hoursExtendedTotal:c,rateTotal:p,laborExtendedTotal:f,materialCostTotal:d,shippingTotal:E,markUpPercent:y,markUpTotal:b,laborCost:N,materialCost:v,totalEstimate:g,modifiedBy:localStorage.userName,taxRate:h.default.findDOMNode(this.refs.taxRate).value?parseInt(h.default.findDOMNode(this.refs.taxRate).value):0,markUp:h.default.findDOMNode(this.refs.defaultMarkup).value?parseInt(h.default.findDOMNode(this.refs.defaultMarkup).value):0};this.props.actions.updateEstimateRevision(I)}},{key:"addRevisionhandler",value:function(){if(this.state.isCheckedDuplicate)if("0"!==h.default.findDOMNode(this.refs.revised.refs.revision_name).value){var e=h.default.findDOMNode(this.refs.revised.refs.revision_name).value,t=this.state.revisedItems.find(function(t){return t._id===e}),a={companyId:localStorage.companyId,estimateId:this.props.params.estimateId,revisionName:"Rev"+(this.state.revisionNo?this.state.revisionNo:0),item:t.lineItems,proposedServices:this.state.proposedServiceValue.toString("html")};this.setState({itemNotExists:!0}),$("#add_revision").modal("hide"),this.props.actions.addOtherRevision(a,2);this.props.params.estimateId}else toastr.error(xe.SELECT_REVISION);else if(this.state.isCheckedEmpty){var l={companyId:localStorage.companyId,estimateId:this.props.params.estimateId,revisionName:"Rev"+this.state.revisionNo,item:[],proposedServices:this.state.proposedServiceValue.toString("html")};this.setState({itemNotExists:!0}),$("#add_revision").modal("hide"),this.props.actions.addOtherRevision(l,2)}}},{key:"handleRevisionExport",value:function(){if(0!=this.state.revisedItems.length){var e=this.state.currentRevisionId;if(e){var t={revisionId:e};this.props.actions.getExportedRevision(t)}else toastr.error(xe.LINE_ITEMS_EMPTY)}}},{key:"createItemHandler",value:function(){$("#add_item").modal("show")}},{key:"addItemHandler",value:function(){if((0,B.default)("#add_other_item").valid()){var e=h.default.findDOMNode(this.refs.itemEstimate.refs.item_name).value.trim(),t=h.default.findDOMNode(this.refs.itemEstimate.refs.item_modalNo).value.trim(),a=h.default.findDOMNode(this.refs.itemEstimate.refs.item_partNo).value.trim(),l=h.default.findDOMNode(this.refs.itemEstimate.refs.item_manufacturer).value.trim(),i=h.default.findDOMNode(this.refs.itemEstimate.refs.supplierName).value.trim(),s=h.default.findDOMNode(this.refs.itemEstimate.refs.listPrice).value.trim(),n=h.default.findDOMNode(this.refs.itemEstimate.refs.dealerPrice).value.trim(),d=[{supplierName:i,listPrice:s.replace(/[^0-9.]/g,""),dealerPrice:n.replace(/[^0-9.]/g,""),priceDate:(0,ae.default)()}],r={companyId:localStorage.companyId,itemName:e,modal:t,partNumber:a,manufacturer:l,itemStatus:"Active",suppliers:d,createdBy:localStorage.userName};this.setState({newAddedSupplier:d,newItemAddFlag:!0}),this.props.itemaction.createItemNew(r),$("#add_item").modal("hide"),$("#lineitem_add").modal("hide")}}},{key:"confirmationHandler",value:function(){$("#confirm_id").modal("hide")}},{key:"getManufacturerList",value:function(e){if(e.target.value&&e.target.value.trim()){this.setState({manufacturerValue:e.target.value});var t={companyId:localStorage.companyId,manufacturer:e.target.value.trim()};this.props.actions.getManufacturerList(t)}else this.setState({manufacturerList:[],manufacturerValue:""})}},{key:"selectManufacturer",value:function(e){this.setState({manufacturerValue:e,manufacturerList:[]})}},{key:"isStringValidNumber",value:function(e){var t=parseInt(e);return!isNaN(t)}},{key:"isStringValidLabor",value:function(e){var t=parseFloat(e);return!(isNaN(t)||t<0)&&t.toString()}},{key:"formatInteger",value:function(e){return e.toString()}},{key:"handleModalOpen",value:function(e){var t=this;t.state.modalName="",$(e).modal({backdrop:"static"}),t.state.modalName=e}},{key:"handleContactPhoneChange",value:function(e){this.setState({new_phone:e.target.value})}},{key:"revisionChangeHandler",value:function(e){this.setState({revisionName:e.target.value})}},{key:"revisionNameHandler",value:function(e,t){var a=this,l=this.state.revisedItems.findIndex(function(e){return e._id===a.state.currentRevisionId}),i=this.state.revisedItems;if("SAVE"==e)if(this.state.revisionName.trim()){var s={revName:this.state.revisionName,revisionId:this.state.currentRevisionId};this.props.actions.renameRevision(s),i[l].revName=this.state.revisionName,this.setState({revisedItems:i}),$("#name_revision").modal("hide")}else toastr.remove(),toastr.error("Please enter a valid name for revision.");else if("REMOVE"==e){var n={revName:"",revisionId:this.state.currentRevisionId};this.props.actions.renameRevision(n),i[l].revName="",this.setState({revisedItems:i}),$("#name_revision").modal("hide")}else this.setState({revisionName:""}),$("#name_revision").modal("hide")}},{key:"getRevisionHeading",value:function(){var e=this,t=this.state.revisedItems.findIndex(function(t){return t._id===e.state.currentRevisionId}),a=this.state.revisedItems[t].revisionName,l=this.state.revisedItems[t].revName;return"- "+a+(l?" - "+l:"")}},{key:"onRevisionNoteChange",value:function(e){this.setState({revisionNotes:e.target.value})}},{key:"handleRevisionNoteUpdate",value:function(){var e=this,t=this.state.revisionNotes,a=this.state.revisedItems.findIndex(function(t){return t._id===e.state.currentRevisionId}),l=this.state.revisedItems.slice();l[a].revisionNotes=t,this.updateRevisionItems(l[a].lineItems)}},{key:"handleItemRefresh",value:function(e,t,a,l){var i=this,s=this.state.revisedItems.findIndex(function(e){return e._id===i.state.currentRevisionId}),n=this.state.revisedItems.slice();n[s].lineItems[a].spin=!0,this.setState({revisedItems:n});var d={itemId:e,lineItemId:t,estimateItemId:this.state.currentRevisionId};this.props.actions.refreshLineItemName(d)}},{key:"sendEditStatus",value:function(){var e=(0,Ce.default)(this.state.endpoint),t=localStorage.completeName;e.emit("edit in progress",t)}},{key:"updateEstimateHandler",value:function(){if((0,B.default)("#createEstimate").valid()){var e={estimateId:this.props.params.estimateId,companyId:localStorage.companyId,customerId:this.state.companyValue?this.state.companyValue.value:"",estimateName:h.default.findDOMNode(this.refs.name).value.trim(),opportunityId:this.state.opportunityValue?this.state.opportunityValue:"",individualId:this.state.individualValue?this.state.individualValue.value:"",proposalId:this.state.proposalValue?this.state.proposalValue:"",projectId:this.state.projectValue?this.state.projectValue:"",billingAddress1:h.default.findDOMNode(this.refs.billAdd1).value.trim(),billingAddress2:h.default.findDOMNode(this.refs.billAdd2).value.trim(),billingcity:h.default.findDOMNode(this.refs.billCity).value.trim(),billingstate:h.default.findDOMNode(this.refs.billState).value.trim(),billingzip:h.default.findDOMNode(this.refs.billZip).value.trim(),shippingAddress1:h.default.findDOMNode(this.refs.shipAdd1).value.trim(),shippingAddress2:h.default.findDOMNode(this.refs.shipAdd2).value.trim(),shippingcity:h.default.findDOMNode(this.refs.shipCity).value.trim(),shippingstate:h.default.findDOMNode(this.refs.shipState).value.trim(),shippingzip:h.default.findDOMNode(this.refs.shipZip).value.trim(),note:h.default.findDOMNode(this.refs.note).value.trim(),proposedServices:this.state.proposedServiceValue.toString("html"),salesRep:this.state.salesrepValue?this.state.salesrepValue.value:"",stage:h.default.findDOMNode(this.refs.stageType).value,modifiedBy:localStorage.userName};re.showLoader("update_estimate"),this.props.actions.updateEstimate(e,this.props.params.estimateId),setTimeout(function(){$("div#update_estimate").unblock()},200)}}},{key:"render",value:function(){var e={display:["INLINE_STYLE_BUTTONS","BLOCK_TYPE_BUTTONS","HISTORY_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Strikethrough",style:"STRIKETHROUGH"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_BUTTONS:[{label:"Unordered List",style:"unordered-list-item"},{label:"Ordered List",style:"ordered-list-item"}]},t=JSON.parse(JSON.stringify(this.state.itemPricedData)),a=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mTaxExtended:e},0),l=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lExtended:e},0),i=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.rowTotal:e},0),s=(this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mOurCost:e},0),this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mOurCostExtended:e},0)),n=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mExtended:e},0),d=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.mTax:e},0),r=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lHoursExtended:e},0),o=this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lExtended:e},0),m=(this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lHours:e},0),this.state.itemPricedData.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lRate:e},0),n),u=d,p=this.state.itemPricedData.reduce(function(e,t){return 3===t.itemTypeId?e+t.rowTotal:e},0),h=n-s,E=100*(n/s-1),b=this.state.estimateDetails;0!=b.length&&b.class,0!=b.length&&(1==b.stage||(2==b.stage||(3==b.stage||(4==b.stage||(5==b.stage||b.stage)))));var v=0,y=0,g=0,I=this.state.itemPricedData.map(function(e,t){return 1==e.itemTypeId?v+=1:2==e.itemTypeId?v+=1:3==e.itemTypeId?v+=1:4==e.itemTypeId&&(v=v),1===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},we,c.default.createElement("td",{style:{textAlign:"center"}},v),c.default.createElement("td",null,e.itemMfg),c.default.createElement("td",null,e.modelNo?e.modelNo:"-"),c.default.createElement("td",null,e.partNo?e.partNo:"-"),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateLineItemsTable.bind(this,t,"DESC")}),c.default.createElement(Q.default,{className:"pull-right refresh-icon-button",loading:e.spin,onClick:this.handleItemRefresh.bind(this,e.itemId,e._id,t),"data-color":"#000","data-size":Y.XS,"data-style":Y.ZOOM_IN,"data-spinner-size":20,"data-spinner-color":"#000","data-spinner-lines":12},Le)),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,2),style:{textAlign:"right",cursor:"pointer"}},e.mTaxExtended?"$"+U.numberWithCommas(e.mTaxExtended.toFixed(2)):"$0"),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,3),style:{textAlign:"right",cursor:"pointer"}},e.lExtended?"$"+U.numberWithCommas(e.lExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Me))):2===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},Ve,c.default.createElement("td",{style:{textAlign:"center"}},v),Pe,$e,Fe,c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},He,c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),We,Ue,c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},"$",c.default.createElement(T.RIEInput,{activeClassName:"form-control input-xsmall",classEditing:"form-control",value:e.rowTotal?U.numberWithCommas(e.rowTotal.toFixed(2)):"0",propName:"data",change:this.updateDesc.bind(this,t,"ROWTOTAL")})),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},qe))):3===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},je,c.default.createElement("td",{style:{textAlign:"center"}},v),ze,Be,Ye,c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},Qe,":",c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),Ge,Ze,Je,c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},"$",c.default.createElement(T.RIEInput,{activeClassName:"form-control input-xsmall",classEditing:"form-control",value:e.rowTotal?U.numberWithCommas(e.rowTotal.toFixed(2)):"0",propName:"data",change:this.updateDesc.bind(this,t,"ROWTOTAL")})),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Ke))):4===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},Xe,c.default.createElement("td",{className:"selectable-header",colSpan:"9",style:{color:"#3598dc"}},c.default.createElement(T.RIEInput,{activeClassName:"form-control input-xlarge",classEditing:"form-control",value:e.headerName?e.headerName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"SUB_HEAD")})),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},et))):void 0}.bind(this)),C=this.state.itemPricedData.map(function(e,t){return 1==e.itemTypeId?y+=1:2==e.itemTypeId?y+=1:3==e.itemTypeId?y+=1:4==e.itemTypeId&&(y=y),1===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},tt,c.default.createElement("td",null,y||""),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,1),style:{textAlign:"right",cursor:"pointer"}},e.itemMfg+" "+e.modelNo+" "+(e.partNo?" ("+e.partNo+")":null)),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),c.default.createElement("td",{style:{textAlign:"center"}},c.default.createElement("div",{className:"md-checkbox",style:{marginLeft:"8px"}},c.default.createElement("input",{type:"checkbox",id:t,className:"md-check",checked:e.mTaxable,value:e.mTaxable,onChange:this.isTaxableUpdate.bind(this,t,"TAXABLE"),style:{minWidth:60}}),c.default.createElement("label",{htmlFor:t},at,lt,it))),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},"$",c.default.createElement(T.RIEInput,{disabled:!1,validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-small",format:this.formatInteger,value:e.mOurCost?U.numberWithCommas(e.mOurCost.toFixed(2)):"$0",propName:"data",change:this.onChangeMarkupCost.bind(this,t,"OURCOST"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"right"}},e.mOurCostExtended?"$"+U.numberWithCommas(e.mOurCostExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},c.default.createElement(T.RIEInput,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-small",format:this.formatInteger,value:e.mMarkup,propName:"data",change:this.onChangeMarkupCost.bind(this,t,"MARKUP"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},"$",c.default.createElement(T.RIEInput,{validate:this.isStringValidNumber,format:this.formatInteger,activeClassName:"form-control input-small",classEditing:"form-control input-small",value:e.mCost?e.mCost.toFixed(2):"$0",propName:"data",change:this.onChangeMarkupCost.bind(this,t,"COST"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"right"}},e.mExtended?"$"+U.numberWithCommas(e.mExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.mTax?"$"+U.numberWithCommas(e.mTax.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.mTaxExtended?"$"+U.numberWithCommas(e.mTaxExtended.toFixed(2)):"$0"),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,3),style:{textAlign:"right",cursor:"pointer"}},e.lExtended?"$"+U.numberWithCommas(e.lExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},st))):2===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},nt,c.default.createElement("td",null,y||""),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},dt,c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),rt,ot,mt,ut,ct,ft,pt,ht,c.default.createElement("td",{style:{textAlign:"right"}},e.lExtended?"$"+U.numberWithCommas(e.lExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Et))):3===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},bt,c.default.createElement("td",null,y||""),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},vt,c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),Nt,yt,gt,It,xt,Tt,Ct,St,Dt,kt,c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},At))):4===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},Rt,c.default.createElement("td",{className:"selectable-header",colSpan:"13",style:{color:"#3598dc"}},c.default.createElement(T.RIEInput,{activeClassName:"form-control input-xlarge",classEditing:"form-control",value:e.headerName?e.headerName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"SUB_HEAD")})),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Ot))):void 0}.bind(this)),D=this.state.itemPricedData.map(function(e,t){return 1==e.itemTypeId?g+=1:2==e.itemTypeId?g+=1:3==e.itemTypeId?g+=1:4==e.itemTypeId&&(g=g),1===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},_t,c.default.createElement("td",null,g||""),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,1),style:{textAlign:"right",cursor:"pointer"}},e.itemMfg+" "+e.modelNo+" "+(e.partNo?" ("+e.partNo+")":null)),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),c.default.createElement("td",{onClick:this.handleLineTab.bind(this,2),style:{textAlign:"right",cursor:"pointer"}},e.mTaxExtended?"$"+U.numberWithCommas(e.mTaxExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{color:"#3598dc"}},c.default.createElement(T.RIESelect,{change:this.handleLaborChange.bind(this,t),value:this.state.laborRatesData.find(function(t){return t.laborType===e.laborTypeName}),options:this.state.laborRatesData,propName:"laborType"})),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIEInput,{validate:this.isStringValidLabor,activeClassName:"form-control input-small",classEditing:"form-control input-small",value:e.lHours>-1?e.lHours.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"HOURS"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"center"}},e.lHoursExtended?e.lHoursExtended.toFixed(2):"0"),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-small",value:e.lRate?e.lRate.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"RATE"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"right"}},e.unit?"$"+U.numberWithCommas(e.unit.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.lExtended?"$"+U.numberWithCommas(e.lExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},wt))):2===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},Lt,c.default.createElement("td",null,g||""),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},Mt,c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-xsmall",value:e.quantity?e.quantity.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"QTY")})),Vt,c.default.createElement("td",{style:{color:"#3598dc"}},c.default.createElement(T.RIESelect,{change:this.handleLaborChange.bind(this,t),value:this.state.laborRatesData.find(function(t){return t.laborType===e.laborTypeName}),options:this.state.laborRatesData,propName:"laborType"})),c.default.createElement("td",{style:{textAlign:"center",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidLabor,activeClassName:"form-control input-small",classEditing:"form-control input-small",value:e.lHours>0?e.lHours.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"HOURS"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"center"}},e.lHoursExtended?e.lHoursExtended.toFixed(2):"0"),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},c.default.createElement(T.RIENumber,{validate:this.isStringValidNumber,activeClassName:"form-control input-small",classEditing:"form-control input-small",value:e.lRate?e.lRate.toString():"0",propName:"data",change:this.updateLineItemsTable.bind(this,t,"RATE"),style:{minWidth:150,display:"inline-block",margin:0,padding:0,fontSize:15,outline:0,border:0}})),c.default.createElement("td",{style:{textAlign:"right"}},e.unit?"$"+U.numberWithCommas(e.unit.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.lExtended?"$"+U.numberWithCommas(e.lExtended.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Pt))):3===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},$t,c.default.createElement("td",null,g||""),c.default.createElement("td",{style:{textAlign:"right",color:"#3598dc"}},Ft,c.default.createElement(T.RIETextArea,{activeClassName:"form-control input-small",classEditing:"form-control",value:e.itemName?e.itemName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"DESC")})),Ht,Wt,Ut,qt,jt,zt,Bt,Yt,c.default.createElement("td",{style:{textAlign:"right"}},e.rowTotal?"$"+U.numberWithCommas(e.rowTotal.toFixed(2)):"$0"),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Qt))):4===e.itemTypeId?c.default.createElement("tr",{key:t,"data-id":t},Gt,c.default.createElement("td",{className:"selectable-header",colSpan:"11",style:{color:"#3598dc"}},c.default.createElement(T.RIEInput,{activeClassName:"form-control input-xlarge",classEditing:"form-control",value:e.headerName?e.headerName:"NA",propName:"data",change:this.updateDesc.bind(this,t,"SUB_HEAD")})),c.default.createElement("td",null,c.default.createElement("span",{className:"btn btn-icon-only red",onClick:this.handleDelete.bind(this,t)},Zt))):void 0}.bind(this)),k=[];t.forEach(function(e){var t=k.filter(function(t){if(3!==t.itemTypeId&&4!==t.itemTypeId)return t.laborTypeName===e.laborTypeName})[0];t?(t.lHours=parseFloat(t.lHours)+parseFloat(e.lHours),t.lExtended+=e.lExtended):k.push(e)});var A=k.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+parseFloat(t.lHours):e},0),R=k.reduce(function(e,t){return 3!==t.itemTypeId&&4!==t.itemTypeId?e+t.lExtended:e},0),O=k.map(function(e,t){if(3!==e.itemTypeId&&4!==e.itemTypeId)return c.default.createElement("tr",{key:t},c.default.createElement("th",{colSpan:"1",style:{textAlign:"right"}},"-",e.laborTypeName),c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(e.lExtended.toFixed(2))))}.bind(this)),_=k.map(function(e,t){if(3!==e.itemTypeId&&4!==e.itemTypeId)return c.default.createElement("tr",{key:t},c.default.createElement("th",{colSpan:"1",style:{textAlign:"right"}},"-",e.laborTypeName),c.default.createElement("td",{style:{textAlign:"right"}},e.lHours))}.bind(this)),w=this.state.itemOptions.map(function(e,t){return c.default.createElement("tr",{key:t},c.default.createElement("td",null,e.manufacturer?e.manufacturer:"-"),c.default.createElement("td",null,e.modal?e.modal:"-"),c.default.createElement("td",null,e.partNumber?e.partNumber:"-"),c.default.createElement("td",null,e.itemName?e.itemName:"-"),c.default.createElement("td",null,c.default.createElement("button",{type:"button",className:"btn btn-xs green",onClick:this.handleItemSubmit.bind(this,t)},"Select item")))}.bind(this)),L=this.state.supplierData.map(function(e,t){return c.default.createElement("tr",{key:t},c.default.createElement("td",null,e.supplierName?e.supplierName:"-"),c.default.createElement("td",null,e.dealerPrice?e.dealerPrice:"-"),c.default.createElement("td",null,e.listPrice?e.listPrice:"-"),c.default.createElement("td",null,e.demoPrice?e.demoPrice:"-"),c.default.createElement("td",null,c.default.createElement("button",{type:"button",className:"btn btn-xs green",onClick:this.handleLineItemAdd.bind(this,t,"")},"Select supplier")))}.bind(this)),M=this.state.opportunityOptions.map(function(e,t){return c.default.createElement("option",{key:t,value:e._id},e.opportunityNumber)}.bind(this)),V=this.state.projectOptions.map(function(e,t){return c.default.createElement("option",{key:t,value:e._id},e.title)}.bind(this)),P=this.state.proposalOptions.map(function(e,t){return c.default.createElement("option",{key:t,value:e._id},e.proposalNumber)}.bind(this)),$=this.state.revisedItems.map(function(e,t){return c.default.createElement("option",{key:t,value:e._id},e.revisionName+(e.revName?" - "+e.revName:""))}.bind(this)),F=this.state.manufacturerList.map(function(e){return c.default.createElement("li",{onClick:this.selectManufacturer.bind(this,e)},c.default.createElement("a",null,e))}.bind(this)),H=this.props.estimateStages.map(function(e,t){return c.default.createElement("option",{key:t,value:e._id},e.stageName)}.bind(this));return c.default.createElement("div",null,c.default.createElement("div",null,c.default.createElement("div",{className:"portlet-title tabbable-line"},c.default.createElement("ul",{className:"nav nav-tabs"},Jt,c.default.createElement("div",{className:"text-right"},c.default.createElement(f.Link,{to:"/estimate/"+this.props.params.estimateId,className:"btn red"},"Cancel "),"  ",c.default.createElement("button",{type:"button",className:"btn blue",onClick:this.updateEstimateHandler},"Save")))),c.default.createElement("div",{className:"portlet light bordered",id:"update_estimate"},c.default.createElement("div",{className:"portlet-body"},c.default.createElement("div",{className:"tab-content"},c.default.createElement("div",{className:"tab-pane active",id:"estimate-add"},Kt,c.default.createElement("form",{role:"form",id:"createEstimate"},c.default.createElement("div",{className:"form-body"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement(ve.default,{parentDivClass:"form-group form-md-line-input form-md-floating-label",defaultValue:this.state.opportunityOptions.length?this.state.opportunityValue:"",key:this.state.opportunityOptions.length?this.state.opportunityValue:"",className:"form-control edited",handleOnChange:this.handleOpportunityChange,title:"Opportunity",name:"opportunity",options:M,ref:"opportunity",id:"opportunity",htmlFor:"opportunity",placeholder:"Select",required:!1,defaultSelect:!0,other:!1})),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},Xt,c.default.createElement("span",{className:"pull-right"},c.default.createElement("i",{className:"fa fa-plus-circle fa-2x","aria-hidden":"true",onClick:this.handleNewContactModal.bind(this,"SALES")})),c.default.createElement(N.default,{disabled:this.state.disabled,value:this.state.salesrepValue,placeholder:"Sales Rep",name:"salesrep",id:"salesrep",options:this.state.salesrepOptions,onBlur:this.handleSelectsBlur,onChange:this.handleSalesRepChange,onInputChange:this.onSalesRepInputChange}))),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},ea,this.state.opportunityValue?null:ta,c.default.createElement(N.default,{value:this.state.companyValue,name:"company",id:"company",options:this.state.companyOptions,onChange:this.handleCompanyChange,onBlur:this.handleSelectsBlur,onInputChange:this.onCompanyInputChange}))),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},aa,c.default.createElement("span",{className:"pull-right"},c.default.createElement("i",{className:"fa fa-plus-circle fa-2x","aria-hidden":"true",onClick:this.handleNewContactModal.bind(this,"INDIVIDUAL")})),c.default.createElement(N.default,{disabled:this.state.disabled,value:this.state.individualValue,placeholder:"Individual",name:"individual",id:"individual",options:this.state.individualOptions,onFocus:this.onContactFocus,onChange:this.handleIndividualChange,onBlur:this.handleSelectsBlur,onInputChange:this.onIndividualInputChange}))),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("input",{type:"text",className:"form-control",id:"name",name:"name",ref:"name",defaultValue:this.state.estimateDetails.estimateName?this.state.estimateDetails.estimateName:"",key:this.state.estimateDetails.estimateName?this.state.estimateDetails.estimateName:""}),la))),ia,c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"billAdd1",name:"billAdd1",defaultValue:this.state.addressDetails.mapAddress1,key:this.state.addressDetails.mapAddress1}),sa)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"billAdd2",name:"billAdd2",defaultValue:this.state.addressDetails.mapAddress2,key:this.state.addressDetails.mapAddress2}),na)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"billCity",name:"billCity",defaultValue:this.state.addressDetails.city,key:this.state.addressDetails.city}),da)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"billState",name:"billState",defaultValue:this.state.addressDetails.state,key:this.state.addressDetails.state}),ra)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"billZip",name:"billZip",defaultValue:this.state.addressDetails.zip,key:this.state.addressDetails.zip}),oa))),ma,c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"shipAdd1",name:"shipAdd1",defaultValue:this.state.shipAddressDetails.mapAddress1,key:this.state.shipAddressDetails.mapAddress1}),ua)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"shipAdd2",name:"shipAdd2",defaultValue:this.state.shipAddressDetails.mapAddress2,key:this.state.shipAddressDetails.mapAddress2}),ca)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"shipCity",name:"shipCity",defaultValue:this.state.shipAddressDetails.city,key:this.state.shipAddressDetails.city}),fa)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"shipState",name:"shipState",defaultValue:this.state.shipAddressDetails.state,key:this.state.shipAddressDetails.state}),pa)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"shipZip",name:"shipZip",defaultValue:this.state.shipAddressDetails.zip,key:this.state.shipAddressDetails.zip}),ha))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement("select",{className:"form-control edited",id:"stageType",ref:"stageType",defaultValue:this.state.estimateDetails.stage&&this.state.estimateDetails.stage._id?this.state.estimateDetails.stage._id:"1",key:this.state.estimateDetails.stage&&this.state.estimateDetails.stage._id?this.state.estimateDetails.stage._id:"1"},H),Ea)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(x.default,{mask:ge.markUpMask,className:"form-control",guide:!1,name:"defaultMarkup",id:"defaultMarkup",ref:"defaultMarkup",htmlFor:"defaultMarkup",value:this.state.defaultMarkup,onBlur:this.handleGlobalMarkup}),ba)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},va,c.default.createElement("select",{key:this.state.projectValue,value:this.state.projectValue?this.state.projectValue:"",onChange:this.handleProjectChange,className:"form-control"},Na,V))),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},ya,c.default.createElement("select",{key:this.state.proposalValue?this.state.proposalValue:"",value:this.state.proposalValue?this.state.proposalValue:"",onChange:this.handleProposalChange,className:"form-control"},ga,P))),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:1,ref:"note",name:"note",defaultValue:this.state.estimateDetails.note?this.state.estimateDetails.note:"",key:this.state.estimateDetails.note?this.state.estimateDetails.note:"-"}),Ia)),c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(x.default,{mask:ge.taxRateMask,className:"form-control",guide:!1,name:"taxRate",id:"taxRate",ref:"taxRate",htmlFor:"taxRate",value:this.state.defaultTaxRate,onBlur:this.handleGlobalTaxRate}),xa))))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-6 col-sm-6 col-xs-12",style:{marginBottom:10}},Ta,c.default.createElement(De.default,{toolbarConfig:e,value:this.state.proposedServiceValue,onChange:this.onChange,className:"Summernote",id:"summernote"}))),c.default.createElement("div",{className:"portlet light portlet-fit portlet-datatable bordered"},c.default.createElement("div",{className:"portlet light bordered"},c.default.createElement("div",{className:"portlet-title tabbable-line"},Ca,0!=this.state.revisedItems.length?[c.default.createElement("label",{key:"0",style:{margin:"10px 0px 0px 10px"},className:"font-dark bold"},this.getRevisionHeading()),c.default.createElement("button",{key:"1",onClick:this.handleRevisionExport,className:"btn green-haze btn-circle btn-sm pull-right",style:{marginTop:"13px",marginLeft:"8px"}},"Export")]:null,c.default.createElement("div",{className:"form-group pull-right",style:{width:"15%",marginTop:"5px"}},c.default.createElement("select",{className:"form-control",defaultValue:this.state.currentRevisionId,key:this.state.currentRevisionId,onChange:this.getRevision},$,c.default.createElement("option",{style:{backgroundColor:"#D3D3D3"},value:"newRevision"},"Add Revision"),c.default.createElement("option",{style:{backgroundColor:"#D3D3D3"},value:"nameRevision"},"Name Selected Revision"),$.length>1?c.default.createElement("option",{style:{backgroundColor:"#D3D3D3"},value:"deleteRevision"},"Delete Revision"):null)),c.default.createElement("ul",{className:"nav nav-tabs"},c.default.createElement("li",{className:this.state.itemTab},c.default.createElement("a",{href:"#portlet_tab1","data-toggle":"tab",onClick:this.handleLineTab.bind(this,1)}," Items ")),c.default.createElement("li",{className:this.state.materialTab},c.default.createElement("a",{href:"#portlet_tab2","data-toggle":"tab",onClick:this.handleLineTab.bind(this,2)}," Material ")),c.default.createElement("li",{className:this.state.laborTab},c.default.createElement("a",{href:"#portlet_tab3","data-toggle":"tab",onClick:this.handleLineTab.bind(this,3)}," Labor ")))),c.default.createElement("div",{className:"portlet-body"},c.default.createElement("div",{className:"tab-content"},c.default.createElement("div",{className:"tab-pane "+this.state.itemTab,id:"portlet_tab1"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"table-container table-responsive",style:{overflow:"auto"}},c.default.createElement("table",{className:"table table-striped table-bordered lineitem"},c.default.createElement("thead",null,c.default.createElement("tr",null,Sa,Da,ka,Aa,Ra,Oa,_a,c.default.createElement("th",{className:"material",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,2)},"Material"),c.default.createElement("th",{className:"labor",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,3)},"Labor"),wa,La)),c.default.createElement("tbody",{id:"sortable"},I),0!=this.state.itemPricedData.length?c.default.createElement("tfoot",null,c.default.createElement("tr",null,Ma,Va,Pa,$a,Fa,Ha,Wa,c.default.createElement("td",{style:{textAlign:"right"}},n?"$"+U.numberWithCommas(n.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},l?"$"+U.numberWithCommas(l.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},i?"$"+U.numberWithCommas(i.toFixed(2)):"$0"),Ua)):null))))),c.default.createElement("div",{className:"tab-pane "+this.state.materialTab,id:"portlet_tab2"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"table-container table-responsive",style:{overflow:"auto"}},c.default.createElement("table",{className:"table table-striped table-bordered lineitem"},c.default.createElement("thead",null,c.default.createElement("tr",null,qa,ja,c.default.createElement("th",{className:"items",rowSpan:"2",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,1)},"Item"),za,Ba,c.default.createElement("th",{className:"labor",rowSpan:"2",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,3)},"Labor"),Ya,Qa),Ga),c.default.createElement("tbody",{id:"sortable1"},C),0!=this.state.itemPricedData.length?c.default.createElement("tfoot",null,c.default.createElement("tr",null,Za,Ja,Ka,Xa,el,tl,c.default.createElement("td",{style:{textAlign:"right"}},s?"$"+U.numberWithCommas(s.toFixed(2)):""),al,ll,c.default.createElement("td",{style:{textAlign:"right"}},n?"$"+U.numberWithCommas(n.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},d?"$"+U.numberWithCommas(d.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},a?"$"+U.numberWithCommas(a.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},l?"$"+U.numberWithCommas(l.toFixed(2)):"$0"),c.default.createElement("td",{style:{textAlign:"right"}},i?"$"+U.numberWithCommas(i.toFixed(2)):"$0"),il)):null))))),c.default.createElement("div",{className:"tab-pane "+this.state.laborTab,id:"portlet_tab3"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"table-container table-responsive",style:{overflow:"auto"}},c.default.createElement("table",{className:"table table-striped table-bordered lineitem"},c.default.createElement("thead",null,c.default.createElement("tr",null,sl,nl,c.default.createElement("th",{className:"items",rowSpan:"2",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,1)},"Item"),dl,c.default.createElement("th",{className:"material",rowSpan:"2",style:{cursor:"pointer"},onClick:this.handleLineTab.bind(this,2)},"Material"),rl,ol,ml),ul),c.default.createElement("tbody",{id:"sortable2"},D),0!=this.state.itemPricedData.length?c.default.createElement("tfoot",null,c.default.createElement("tr",null,cl,fl,pl,hl,c.default.createElement("td",{style:{textAlign:"right"}},a?"$"+U.numberWithCommas(a.toFixed(2)):"$0"),El,bl,c.default.createElement("td",{style:{textAlign:"center"}},r?r.toFixed(2):""),c.default.createElement("td",{style:{textAlign:"right"}},c.default.createElement("span",null)),vl,c.default.createElement("td",{style:{textAlign:"right"}},c.default.createElement("span",null,o?"$"+U.numberWithCommas(o.toFixed(2)):"$0")),c.default.createElement("td",{style:{textAlign:"right"}},c.default.createElement("span",null,i?"$"+U.numberWithCommas(i.toFixed(2)):"$0")),Nl)):null))))))),c.default.createElement("div",{className:"portlet-title"},yl,"  ",c.default.createElement("a",{onClick:this.handleModalOpen.bind(this,"#lineitem_add"),"data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle green"},gl,"Material"),"  ",c.default.createElement("a",{onClick:this.handleModalOpen.bind(this,"#labor_add"),"data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle blue"},Il,"Labor"),"  ",c.default.createElement("a",{onClick:this.handleModalOpen.bind(this,"#subheader_add"),"data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle yellow"},xl,"Sub-Header"),"  ",c.default.createElement("a",{onClick:this.handleModalOpen.bind(this,"#shipping_add"),"data-backdrop":"static","data-keyboard":"false",className:"btn btn-sm btn-circle purple"},Tl,"Shipping")),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12 col-sm-12 col-xs-12"},c.default.createElement("div",{className:"form-group form-md-line-input form-md-floating-label"},c.default.createElement(S.default,{style:{resize:"none"},className:"form-control",rows:2,ref:"revisionNotes",name:"revisionNotes",value:this.state.revisionNotes,onChange:this.onRevisionNoteChange,onBlur:this.handleRevisionNoteUpdate}),Cl))),0!=this.state.itemPricedData.length?c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-4"},c.default.createElement("table",{className:"table table-striped table-bordered"},Sl,c.default.createElement("tbody",null,c.default.createElement("tr",null,Dl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(m.toFixed(2)))),c.default.createElement("tr",null,kl,c.default.createElement("td",{style:{textAlign:"right"}},"$",s?U.numberWithCommas(s.toFixed(2)):0)),c.default.createElement("tr",null,Al,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(u.toFixed(2)))),c.default.createElement("tr",null,Rl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(p.toFixed(2)))),c.default.createElement("tr",null,Ol,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(a.toFixed(2)))),c.default.createElement("tr",null,_l,c.default.createElement("td",{style:{textAlign:"right"}},isNaN(E)?0:E.toFixed(2),"%")),c.default.createElement("tr",null,wl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(h.toFixed(2))))))),c.default.createElement("div",{className:"col-md-4"},c.default.createElement("table",{className:"table table-striped table-bordered"},Ll,c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("th",{colSpan:"1"},"Total ",c.default.createElement("span",{onClick:this.handleExpand.bind(this,"TOTAL"),style:{color:"blue",cursor:"pointer"}},this.state.expandTotal?" (less...)":"(more...)")),c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(R.toFixed(2)))),this.state.expandTotal?O:null,c.default.createElement("tr",null,c.default.createElement("th",{colSpan:"1"},"Hours ",c.default.createElement("span",{onClick:this.handleExpand.bind(this,"HOURS"),style:{color:"blue",cursor:"pointer"}},this.state.expandHours?" (less...)":"(more...)")),c.default.createElement("td",{style:{textAlign:"right"}},A)),this.state.expandHours?_:null))),c.default.createElement("div",{className:"col-md-4"},c.default.createElement("table",{className:"table table-striped table-bordered"},Ml,c.default.createElement("tbody",null,c.default.createElement("tr",null,Vl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(m.toFixed(2)))),c.default.createElement("tr",null,Pl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(R.toFixed(2)))),c.default.createElement("tr",null,$l,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(u.toFixed(2)))),c.default.createElement("tr",null,Fl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas(p.toFixed(2)))),c.default.createElement("tr",null,Hl,c.default.createElement("td",{style:{textAlign:"right"}},"$",U.numberWithCommas((n+R+u+p).toFixed(2)))))))):null))),c.default.createElement(me.default,{materialAddId:"lineitem_add",onItemInputChange:this.onItemInputChange,itemOptions:this.state.itemOptions,searchedItems:w,handlePopUpClose:this.handlePopUpClose.bind(this,"item"),createItemHandler:this.createItemHandler.bind(this,"item")}),c.default.createElement(pe.default,{ref:"head_txt",headerAddId:"subheader_add",handleHeaderAdd:this.handleHeaderAdd}),c.default.createElement(ce.default,{ref:"ship_desc",shippingAddId:"shipping_add",handleShippingAdd:this.handleShippingAdd}),c.default.createElement(Ee.default,{ref:"labr_desc",laborAddId:"labor_add",handleLaborAdd:this.handleLaborAdd}),c.default.createElement("div",{id:"supplier_add",className:"modal fade",tabIndex:"-1","aria-hidden":"true"},c.default.createElement("div",{className:"modal-dialog "},c.default.createElement("div",{className:"modal-content"},Wl,c.default.createElement("div",{className:"modal-body"},c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"table-container table-responsive",style:{height:"150px",overflow:"auto"}},c.default.createElement("table",{className:"table table-striped table-bordered"},Ul,c.default.createElement("tbody",null,L)))))),c.default.createElement("div",{className:"modal-footer"},c.default.createElement("button",{type:"button",className:"btn dark btn-outline",onClick:this.handlePopUpClose.bind(this,"supplier")},"Close"))))),c.default.createElement(ee.default,{addContactModalId:"add-contact",companyValue:this.state.companyValue,contactAddhandler:this.handleContactAdd,ref:"contactChild",phoneValue:this.state.new_phone,handleContactPhoneChange:this.handleContactPhoneChange}),c.default.createElement(ie.default,{mfgList:F,onInputChange:this.getManufacturerList,manufacturerValue:this.state.manufacturerValue,itemModalId:"add_item",addItemHandler:this.addItemHandler,ref:"itemEstimate",handlePopUpClose:this.handlePopUpClose.bind(this,"newItem")}),c.default.createElement(K.default,{deleteModalId:"lineItem_delete",deleteUserHandler:this.deletePricedItem}),c.default.createElement(Z.default,{revisionModalId:"add_revision",isCheckedDuplicate:this.state.isCheckedDuplicate,isCheckedEmpty:this.state.isCheckedEmpty,addRevision:this.addRevisionhandler,revisionNo:this.state.revisionNo,radioHandler:this.handleRadioUpdate,revisedItems:$,ref:"revised"}),c.default.createElement(ne.default,{confirmationId:"confirm_id",confirmationTitle:"",confirmationText:"Are you sure you want to create a new item in the database ?",confirmationHandler:this.confirmationHandler}),c.default.createElement(ye.default,{modalId:"name_revision",revName:this.state.revisionName,revisionChangeHandler:this.revisionChangeHandler,revisionNameHandler:this.revisionNameHandler}))))))}}]),t}(c.default.Component);t.default=(0,E.connect)(r,o)(ql)}});